<div class="container">

<table style="width: 100%;"><tr>
<td>spectral_entropy_calculator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Spectral Entropy Calculator
</h2>

<h3>Description</h3>

<p>This module calculates spectral entropy for a fragmentation pattern using a method described by the reference paper.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectral_entropy_calculator(FragmentList, allowedWeightedSpectralEntropy = TRUE,
noiseRemovalRatio = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FragmentList</code></td>
<td>

<p>A matrix (m/z, int) of fragmentation pattern after intensity adjustment
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowedWeightedSpectralEntropy</code></td>
<td>

<p>c(TRUE, FALSE). Weighted entropy to transform low abundant signals prior to calculating entropy similarity score. Please see the reference for details on weight transformation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseRemovalRatio</code></td>
<td>

<p>noise removal ratio ([0 - 1])relative to the basepeak to measure entropy similarity score.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectralEntropy</code></td>
<td>

<p>spectral entropy
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumPeaks</code></td>
<td>

<p>NumPeaks
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FragmentList</code></td>
<td>

<p>A matrix of two-columns after intensity normalization relative to summation of intensities AND entropy weight transformation when is selected.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>noise removal on intensities should be performed prior to feeding to this function
</p>


<h3>References</h3>

<p>Li, Y., Kind, T., Folz, J., Vaniya, A., Mehta, S.S. and Fiehn, O. (2021). Spectral entropy outperforms MS/MS dot product similarity for small-molecule compound identification. <em>Nature methods</em>, 18(12), 1524-1531, <a href="https://doi.org/10.1038/s41592-021-01331-z">doi:10.1038/s41592-021-01331-z</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">FragmentList &lt;- cbind(seq(50, 600, length.out = 10), seq(10, 90, length.out = 10))
SE &lt;- spectral_entropy_calculator(FragmentList)
print(SE[[1]])
</code></pre>


</div>