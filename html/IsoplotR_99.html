<div class="container">

<table style="width: 100%;"><tr>
<td>isochron</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate and plot isochrons</h2>

<h3>Description</h3>

<p>Plots cogenetic U-Pb, Ar-Ar, K-Ca, Pb-Pb, Th-Pb, Rb-Sr, Sm-Nd,
Re-Os, Lu-Hf, U-Th-He or Th-U data as X-Y scatterplots, fits an
isochron curve through them using the <code>york</code>,
<code>titterington</code> or <code>ludwig</code> function, and computes the
corresponding isochron age, including decay constant uncertainties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">isochron(x, ...)

## Default S3 method:
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  xlab = "x",
  ylab = "y",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  title = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'other'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  xlab = "x",
  ylab = "y",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  title = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  flippable = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'UPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  joint = TRUE,
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  type = 1,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  show.ellipses = 1 * (model != 2),
  anchor = 0,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  y0option = 1,
  taxis = FALSE,
  ...
)

## S3 method for class 'PbPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = TRUE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  growth = FALSE,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ArAr'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = TRUE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'ThPb'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'KCa'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  inverse = FALSE,
  ci.col = "gray80",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  bratio = 0.895,
  ...
)

## S3 method for class 'RbSr'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'ReOs'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'SmNd'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'LuHf'
isochron(
  x,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  inverse = FALSE,
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  taxis = FALSE,
  ...
)

## S3 method for class 'UThHe'
isochron(
  x,
  sigdig = 2,
  oerr = 3,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  model = 1,
  wtype = 1,
  anchor = 0,
  show.ellipses = 2 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)

## S3 method for class 'ThU'
isochron(
  x,
  type = 2,
  oerr = 3,
  sigdig = 2,
  show.numbers = FALSE,
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#FF000080"),
  ellipse.stroke = "black",
  ci.col = "gray80",
  line.col = "black",
  lwd = 1,
  plot = TRUE,
  exterr = FALSE,
  model = 1,
  wtype = "a",
  show.ellipses = 1 * (model != 2),
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  y0option = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>EITHER a matrix with the following five columns:
</p>
<p><code>X</code>: the x-variable
</p>
<p><code>sX</code>: the standard error of <code>X</code>
</p>
<p><code>Y</code>: the y-variable
</p>
<p><code>sY</code>: the standard error of <code>Y</code>
</p>
<p><code>rXY</code>: the correlation coefficient of <code>X</code> and <code>Y</code>
</p>
<p>OR
</p>
<p>an object of class <code>ArAr</code>, <code>KCa</code>, <code>PbPb</code>,
<code>UPb</code>, <code>ThPb</code>, <code>ReOs</code>, <code>RbSr</code>, <code>SmNd</code>,
<code>LuHf</code>, <code>UThHe</code> or <code>ThU</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed on to <code>scatterplot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigdig</code></td>
<td>
<p>the number of significant digits of the numerical
values reported in the title of the graphical output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.numbers</code></td>
<td>
<p>logical flag (<code>TRUE</code> to show grain numbers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clabel</code></td>
<td>
<p>label for the colour scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>text label for the horizontal plot axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>text label for the vertical plot axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>,
etc.
</p>
<p>For empty ellipses, set <code>ellipse.col=NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.col</code></td>
<td>
<p>the fill colour for the confidence interval of the
intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>colour of the isochron line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>FALSE</code>, suppresses the graphical output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>add a title to the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>construct the isochron using either:
</p>
<p><code>1</code>: Error-weighted least squares regression
</p>
<p><code>2</code>: Total least squares regression
</p>
<p><code>3</code>: Error-weighted least squares with overdispersion term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtype</code></td>
<td>
<p>controls the parameter responsible for the
overdispersion in model-3 regression.
</p>
<p>If <code>x</code> has class <code>PbPb</code>, <code>ArAr</code> or <code>PD</code>,
<code>wtype</code> can have one of two values:
</p>

<ul>
<li> <p><code>1</code>: attribute the overdispersion to variability in the
non-radiogenic component, as controlled by <code>settings('iratio',...)</code>
</p>
</li>
<li> <p><code>2</code>: attribute the overdispersion to variability in the
age, i.e. to diachronous closure of the isotope system.
</p>
</li>
</ul>
<p>otherwise, <code>wtype</code> can have one of four values:
</p>

<ul>
<li> <p><code>1</code>: attributes the overdispersion to the y-intercept of
the equivalent conventional isochron.
</p>
</li>
<li> <p><code>2</code>: attributes the overdispersion to the slope of the
equivalent conventional isochron.
</p>
</li>
<li> <p><code>'A'</code>: only available if <code>x</code> has class <code>ThU</code> and
<code>x$format</code> is 1 or 2. Attributes the overdispersion to the
authigenic <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U-intercept of the isochron.
</p>
</li>
<li> <p><code>'B'</code>: only available if <code>x</code> has class <code>ThU</code> and
<code>x$format</code> is 1 or 2. Attributes the overdispersion to the
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-slope of the isochron.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anchor</code></td>
<td>
<p>control parameters to fix the intercept age or common
Pb composition of the isochron fit. This can be a scalar or a
vector.
</p>
<p>If <code>anchor[1]=0</code>: do not anchor the isochron.
</p>
<p>If <code>anchor[1]=1</code>: fix the common Pb composition at the values
stored in <code>settings('iratio',...)</code>.
</p>
<p>If <code>anchor[1]=2</code>: force the isochron line to intersect the
concordia line at an age equal to <code>anchor[2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.ellipses</code></td>
<td>
<p>show the data as:
</p>
<p><code>0</code>: points
</p>
<p><code>1</code>: error ellipses
</p>
<p><code>2</code>: error crosses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the isochron age calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flippable</code></td>
<td>
<p>controls if generic data (where <code>x</code> has class
<code>other</code> and <code>x$format</code> is either <code>4</code> or
<code>5</code>) should be treated as inverse isochrons
(<code>flippable=1</code>) or as conventional isochrons
(<code>flippable=2</code>). If <code>flippable=0</code> (which is the
default value), then the data are passed on to
<code>isochron.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>logical. Only applies to U-Pb data formats 4 and
above. If <code>TRUE</code>, carries out three dimensional
regression.  If <code>FALSE</code>, uses two dimensional isochron
regression.  The latter can be used to compute
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{235}</code>U isochrons, which are immune to
the complexities of initial <code class="reqn">{}^{234}</code>U/<code class="reqn">{}^{238}</code>U
disequilibrium.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>x</code> has class <code>UPb</code> and <code>x$format=4</code>,
<code>5</code> or <code>6</code>:
</p>
<p><code>1</code>: <code class="reqn">^{204}</code>Pb/<code class="reqn">^{206}</code>Pb vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{206}</code>Pb
</p>
<p><code>2</code>: <code class="reqn">^{204}</code>Pb/<code class="reqn">^{207}</code>Pb vs. <code class="reqn">^{235}</code>U/<code class="reqn">^{207}</code>Pb
</p>
<p>if <code>x</code> has class <code>UPb</code> and <code>x$format=7</code> or <code>8</code>:
</p>
<p><code>1</code>: <code class="reqn">^{208}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{206}</code>Pb vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{206}</code>Pb
</p>
<p><code>2</code>: <code class="reqn">^{208}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{207}</code>Pb vs. <code class="reqn">^{235}</code>U/<code class="reqn">^{207}</code>Pb
</p>
<p><code>3</code>: <code class="reqn">^{206}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{208}</code>Pb
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{208}</code>Pb
</p>
<p><code>4</code>: <code class="reqn">^{207}</code>Pb<code class="reqn">{}_\circ</code>/<code class="reqn">^{208}</code>Pb
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{208}</code>Pb
</p>
<p>if <code>x</code> has class <code>ThU</code>, and following the classification
of Ludwig and Titterington (1994), one of either:
</p>
<p><code>1</code>: ‘Rosholt type-II’ isochron, setting out
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th
</p>
<p><code>2</code>: ‘Osmond type-II’ isochron, setting out <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U
</p>
<p><code>3</code>: ‘Rosholt type-II’ isochron, setting out <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th
vs. <code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th
</p>
<p><code>4</code>: ‘Osmond type-II’ isochron, setting out
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U vs. <code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exterr</code></td>
<td>
<p>propagate external sources of uncertainty
(J, decay constant)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0option</code></td>
<td>
<p>controls the type of y-intercept or activity ratio
that is reported along with the isochron age. Only relevant to
U-Pb data and Th-U data formats 1 and 2.
</p>
<p>For U-Pb data:
</p>
<p><code>y0option=1</code> reports the common Pb composition,
</p>
<p><code>y0option=2</code> reports the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratio.
</p>
<p><code>y0option=3</code> reports the initial <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
activity ratio,
</p>
<p>For Th-U data:
</p>
<p><code>y0option=1</code> reports the authigenic
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U activity ratio,
</p>
<p><code>y0option=2</code> reports the detrital
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th activity ratio,
</p>
<p><code>y0option=3</code> reports the authigenic
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U activity ratio,
</p>
<p><code>y0option=4</code> reports the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxis</code></td>
<td>
<p>logical. If <code>TRUE</code>, replaces the x-axis of the
inverse isochron with a time scale. Only applies if
<code>inverse</code> is <code>TRUE</code> or, when <code>x</code> has class
<code>U-Pb</code>, if <code>x$format</code> is 4 or higher.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p>toggles between normal and inverse isochrons. If the
isochron plots <code>Y</code> against <code>X</code>, and
</p>
<p>If <code>inverse=TRUE</code>, then <code>X</code> =
<code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{206}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{206}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{208}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{204}</code>Pb/<code class="reqn">{}^{208}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{40}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{36}</code>Ar/<code class="reqn">{}^{40}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{40}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{44}</code>Ca/<code class="reqn">{}^{40}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{87}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{86}</code>Sr/<code class="reqn">{}^{87}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{143}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{144}</code>Nd/<code class="reqn">{}^{143}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{187}</code>Os and
<code>Y</code> = <code class="reqn">{}^{188}</code>Os/<code class="reqn">{}^{187}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{176}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{177}</code>Hf/<code class="reqn">{}^{176}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).
</p>
<p>If <code>inverse=FALSE</code>, then <code>X</code> =
<code class="reqn">{}^{206}</code>Pb/<code class="reqn">{}^{204}</code>Pb and <code>Y</code> =
<code class="reqn">{}^{207}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>PbPb</code>), or <code>X</code> = <code class="reqn">{}^{232}</code>Th/<code class="reqn">{}^{204}</code>Pb and
<code>Y</code> = <code class="reqn">{}^{208}</code>Pb/<code class="reqn">{}^{204}</code>Pb (if <code>x</code> has class
<code>ThPb</code>), or <code>X</code> = <code class="reqn">{}^{39}</code>Ar/<code class="reqn">{}^{36}</code>Ar and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ar/<code class="reqn">{}^{36}</code>Ar (if <code>x</code> has class
<code>ArAr</code>), or <code>X</code> = <code class="reqn">{}^{40}</code>K/<code class="reqn">{}^{44}</code>Ca and
<code>Y</code> = <code class="reqn">{}^{40}</code>Ca/<code class="reqn">{}^{44}</code>Ca (if <code>x</code> has class
<code>KCa</code>), or <code>X</code> = <code class="reqn">{}^{87}</code>Rb/<code class="reqn">{}^{86}</code>Sr and
<code>Y</code> = <code class="reqn">{}^{87}</code>Sr/<code class="reqn">{}^{86}</code>Sr (if <code>x</code> has class
<code>RbSr</code>), or <code>X</code> = <code class="reqn">{}^{147}</code>Sm/<code class="reqn">{}^{144}</code>Nd and
<code>Y</code> = <code class="reqn">{}^{143}</code>Nd/<code class="reqn">{}^{144}</code>Nd (if <code>x</code> has class
<code>SmNd</code>), or <code>X</code> = <code class="reqn">{}^{187}</code>Re/<code class="reqn">{}^{188}</code>Os and
<code>Y</code> = <code class="reqn">{}^{187}</code>Os/<code class="reqn">{}^{188}</code>Os (if <code>x</code> has class
<code>ReOs</code>), or <code>X</code> = <code class="reqn">{}^{176}</code>Lu/<code class="reqn">{}^{177}</code>Hf and
<code>Y</code> = <code class="reqn">{}^{176}</code>Hf/<code class="reqn">{}^{177}</code>Hf (if <code>x</code> has class
<code>LuHf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>growth</code></td>
<td>
<p>add Stacey-Kramers Pb-evolution curve to the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bratio</code></td>
<td>
<p>the <code class="reqn">^{40}</code>K branching ratio.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given several aliquots from a single sample, isochrons allow the
non-radiogenic component of the daughter nuclide to be quantified
and separated from the radiogenic component. In its simplest form,
an isochron is obtained by setting out the amount of radiogenic
daughter against the amount of radioactive parent, both normalised
to a non-radiogenic isotope of the daughter element, and fitting a
straight line through these points by least squares regression
(Nicolaysen, 1961). The slope and intercept then yield the
radiogenic daughter-parent ratio and the non-radiogenic daughter
composition, respectively. There are several ways to fit an
isochron.  The easiest of these is total least squares
regression, which weighs all data points equally. In the presence
of quantifiable analytical uncertainty, it is equally
straightforward to use the inverse of the y-errors as weights.  It
is significantly more difficult to take into account uncertainties
in both the x- and the y-variable (York, 1966). <code>IsoplotR</code>
does so for its U-Th-He isochron calculations. The York (1966)
method assumes that the analytical uncertainties of the x- and
y-variables are independent from each other. This assumption is
rarely met in geochronology.  York (1968) addresses this issue with
a bivariate error weighted linear least squares algorithm that
accounts for covariant errors in both variables. This algorithm was
further improved by York et al. (2004) to ensure consistency with
the maximum likelihood approach of Titterington and Halliday
(1979).
</p>
<p><code>IsoplotR</code> uses the York et al. (2004) algorithm for its
Ar-Ar, K-Ca, Pb-Pb, Th-Pb, Rb-Sr, Sm-Nd, Re-Os and Lu-Hf
isochrons. The maximum likelihood algorithm of Titterington and
Halliday (1979) was generalised from two to three dimensions by
Ludwig and Titterington (1994) for U-series disequilibrium dating.
Also this algorithm is implemented in <code>IsoplotR</code>. Finally, the
constrained maximum likelihood algorithms of Ludwig (1998) and
Vermeesch (2020) are used for isochron regression of U-Pb data. The
extent to which the observed scatter in the data can be explained
by the analytical uncertainties can be assessed using the Mean
Square of the Weighted Deviates (MSWD, McIntyre et al., 1966),
which is defined as:
</p>
<p><code class="reqn">MSWD = ([X - \hat{X}] \Sigma_{X}^{-1} [X - \hat{X}]^T)/df</code>
</p>
<p>where <code class="reqn">X</code> are the data, <code class="reqn">\hat{X}</code> are the fitted values,
and <code class="reqn">\Sigma_X</code> is the covariance matrix of <code class="reqn">X</code>, and <code class="reqn">df
= k(n-1)</code> are the degrees of freedom, where <code class="reqn">k</code> is the
dimensionality of the linear fit. MSWD values that are far smaller
or greater than 1 indicate under- or overdispersed measurements,
respectively. Underdispersion can be attributed to overestimated
analytical uncertainties. <code>IsoplotR</code> provides three
alternative strategies to deal with overdispersed data:
</p>

<ol>
<li>
<p> Attribute the overdispersion to an underestimation of the
analytical uncertainties. In this case, the excess scatter can be
accounted for by inflating those uncertainties by a <em>factor</em>
<code class="reqn">\sqrt{MSWD}</code>.
</p>
</li>
<li>
<p> Ignore the analytical uncertainties and perform a total
least squares regression.
</p>
</li>
<li>
<p> Attribute the overdispersion to the presence of 'geological
scatter'.  In this case, the excess scatter can be accounted for by
adding an overdispersion <em>term</em> that lowers the MSWD to unity.
</p>
</li>
</ol>
<h3>Value</h3>

<p>If <code>x</code> has class <code>PbPb</code>, <code>ThPb</code>,
<code>ArAr</code>, <code>KCa</code>, <code>RbSr</code>, <code>SmNd</code>, <code>ReOs</code>
or <code>LuHf</code>, or <code>UThHe</code>, returns a list with the
following items:
</p>

<dl>
<dt>a</dt>
<dd>
<p>the intercept of the straight line fit and its standard
error.</p>
</dd>
<dt>b</dt>
<dd>
<p>the slope of the fit and its standard error.</p>
</dd>
<dt>cov.ab</dt>
<dd>
<p>the covariance of the slope and intercept</p>
</dd>
<dt>df</dt>
<dd>
<p>the degrees of freedom of the linear fit (<code class="reqn">df=n-2</code>
for non-anchored fits)</p>
</dd>
<dt>y0</dt>
<dd>
<p>a two- or three-element list containing:
</p>
<p><code>y</code>: the atmospheric <code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar or initial
<code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{87}</code>Rb, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd,
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or <code class="reqn">^{208}</code>Pb/<code class="reqn">^{204}</code>Pb
ratio.
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only applicable if <code> model=1</code>).  </p>
</dd>
<dt>age</dt>
<dd>
<p>a three-element list containing:
</p>
<p><code>t</code>: the <code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb,
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th, <code class="reqn">^{40}</code>Ar/<code class="reqn">^{39}</code>Ar,
<code class="reqn">^{40}</code>K/<code class="reqn">^{40}</code>Ca, <code class="reqn">^{187}</code>Os/<code class="reqn">^{187}</code>Re,
<code class="reqn">^{87}</code>Sr/<code class="reqn">^{87}</code>Rb, <code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd or
<code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf age.
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only applicable if <code> model=1</code>).  </p>
</dd>
<dt>mswd</dt>
<dd>
<p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic (omitted if <code>model=2</code>).</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value of a Chi-square test for linearity
(omitted if <code>model=2</code>)</p>
</dd>
<dt>w</dt>
<dd>
<p>the overdispersion term, i.e. a two-element vector with
the standard deviation of the (assumed) normally distributed
geological scatter that underlies the measurements, and its
standard error (only returned if <code>model=3</code>).</p>
</dd>
<dt>ski</dt>
<dd>
<p>(only reported if <code>x</code> has class <code>PbPb</code> and
<code>growth</code> is <code>TRUE</code>) the intercept(s) of the isochron with
the Stacey-Kramers mantle evolution curve.</p>
</dd>
</dl>
<p>OR, if <code>x</code> has class <code>ThU</code>:
</p>

<dl>
<dt>par</dt>
<dd>
<p>if <code>x$type=1</code> or <code>x$type=3</code>: the best fitting
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th intercept,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U slope, <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th
intercept and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U slope, OR, if
<code>x$type=2</code> or <code>x$type=4</code>: the best fitting
<code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U intercept,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th slope, <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
intercept and <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th slope.  </p>
</dd>
<dt>cov</dt>
<dd>
<p>the covariance matrix of <code>par</code>.</p>
</dd>
<dt>df</dt>
<dd>
<p>the degrees of freedom for the linear fit, i.e. <code class="reqn">(3n-3)</code> if
<code>x$format=1</code> or <code>x$format=2</code>, and <code class="reqn">(2n-2)</code> if
<code>x$format=3</code> or <code>x$format=4</code></p>
</dd>
<dt>a</dt>
<dd>
<p>if <code>type=1</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th
intercept; if <code>type=2</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U
intercept; if <code>type=3</code>: the <code class="reqn">^{234}</code>Th/<code class="reqn">^{232}</code>Th
intercept; if <code>type=4</code>: the <code class="reqn">^{234}</code>Th/<code class="reqn">^{238}</code>U
intercept and its propagated uncertainty.</p>
</dd>
<dt>b</dt>
<dd>
<p>if <code>type=1</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U slope;
if <code>type=2</code>: the <code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th slope; if
<code>type=3</code>: the <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U slope; if
<code>type=4</code>: the <code class="reqn">^{234}</code>U/<code class="reqn">^{232}</code>Th slope and its
propagated uncertainty.</p>
</dd>
<dt>cov.ab</dt>
<dd>
<p>the covariance between <code>a</code> and <code>b</code>.</p>
</dd>
<dt>mswd</dt>
<dd>
<p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value of a Chi-square test for linearity.</p>
</dd>
<dt>y0</dt>
<dd>
<p>a three-element vector containing:
</p>
<p><code>y</code>: the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratio
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code>.</p>
</dd>
<dt>age</dt>
<dd>
<p>a two (or three) element vector containing:
</p>
<p><code>t</code>: the initial <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U-ratio
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only reported if <code>model=1</code>).</p>
</dd>
<dt>w</dt>
<dd>
<p>the overdispersion term, i.e. a two-element vector with
the standard deviation of the (assumedly) Normally distributed
geological scatter that underlies the measurements, and its
standard error.</p>
</dd>
<dt>d</dt>
<dd>
<p>a matrix with the following columns: the X-variable for
the isochron plot, the analytical uncertainty of X, the Y-variable
for the isochron plot, the analytical uncertainty of Y, and the
correlation coefficient between X and Y.</p>
</dd>
<dt>xlab</dt>
<dd>
<p>the x-label of the isochron plot</p>
</dd>
<dt>ylab</dt>
<dd>
<p>the y-label of the isochron plot</p>
</dd>
</dl>
<p>OR if <code>x</code> has class <code>UPb</code>:
</p>

<dl>
<dt>par</dt>
<dd>
<p>if <code>model=1</code> or <code>2</code>, a three element vector
containing the isochron age and the common Pb isotope ratios. If
<code>model=3</code>, adds a fourth element with the overdispersion
parameter <code class="reqn">w</code>.</p>
</dd>
<dt>cov</dt>
<dd>
<p>the covariance matrix of <code>par</code></p>
</dd>
<dt>logpar</dt>
<dd>
<p>the logarithm of <code>par</code></p>
</dd>
<dt>logcov</dt>
<dd>
<p>the logarithm of <code>cov</code></p>
</dd>
<dt>n</dt>
<dd>
<p>the number of analyses in the dataset</p>
</dd>
<dt>df</dt>
<dd>
<p>the degrees of freedom for the linear fit, i.e. <code class="reqn">2n-3</code></p>
</dd>
<dt>a</dt>
<dd>
<p>the y-intercept and its standard error</p>
</dd>
<dt>b</dt>
<dd>
<p>the isochron slope and its standard error</p>
</dd>
<dt>cov.ab</dt>
<dd>
<p>the covariance between <code>a</code> and <code>b</code>.</p>
</dd>
<dt>mswd</dt>
<dd>
<p>the mean square of the residuals (a.k.a 'reduced
Chi-square') statistic.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value of a Chi-square test for linearity.</p>
</dd>
<dt>y0</dt>
<dd>
<p>a two or three-element vector containing:
</p>
<p><code>y</code>: the initial <code class="reqn">^{206}</code>Pb/<code class="reqn">^{204}</code>Pb-ratio (if
<code>type=1</code> and <code>x$format=4,5</code> or <code>6</code>);
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb-ratio (if <code>type=2</code> and
<code>x$format=4,5</code> or <code>6</code>);
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{206}</code>Pb-ratio (if <code>type=1</code> and
<code>x$format=7</code> or <code>8</code>); 
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{207}</code>Pb-ratio (if <code>type=2</code> and
<code>x$format=7</code> or <code>8</code>);
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{208}</code>Pb-ratio (if <code>type=3</code> and
<code>x$format=7</code> or <code>8</code>); or
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{208}</code>Pb-ratio (if <code>type=4</code> and
<code>x$format=7</code> or <code>8</code>).
</p>
<p><code>s[y]</code>: the standard error of <code>y</code>
</p>
<p><code>disp[y]</code>: the standard error of <code>y</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only returned if <code>model=1</code>)</p>
</dd>
<dt>y0label</dt>
<dd>
<p>the y-axis label of the isochron plot</p>
</dd>
<dt>age</dt>
<dd>
<p>a two (or three) element vector containing:
</p>
<p><code>t</code>: the isochron age
</p>
<p><code>s[t]</code>: the standard error of <code>t</code>
</p>
<p><code>disp[t]</code>: the standard error of <code>t</code> enhanced by
<code class="reqn">\sqrt{mswd}</code> (only reported if <code>model=1</code>).</p>
</dd>
<dt>xlab</dt>
<dd>
<p>the x-label of the isochron plot</p>
</dd>
<dt>ylab</dt>
<dd>
<p>the y-label of the isochron plot</p>
</dd>
</dl>
<p>OR, if <code>x</code> has class <code>other</code> and <code>x$format</code> is
either <code>4</code> or <code>5</code> and <code>flippable</code> is not <code>0</code>,
returns
</p>
<p><code>Dd</code>: the ratio of the inherited radiogenic daughter to its
nonradiogenic sister isotope
</p>
<p><code>DP</code>: the ratio fo the radiogic daughter to its radioactive parent
</p>
<p><code>cov.DdDP</code>: the covariance between <code>Dd</code> and <code>DP</code>.
</p>
<p>In the remaining types of <code>other</code> data, the intercept <code>a</code>
and <code>b</code> are returned along with their covariance.
</p>


<h3>References</h3>

<p>Ludwig, K.R. and Titterington, D.M., 1994. Calculation of
<code class="reqn">^{230}</code>Th/U isochrons, ages, and errors. Geochimica et
Cosmochimica Acta, 58(22), pp.5031-5042.
</p>
<p>Ludwig, K.R., 1998. On the treatment of concordant uranium-lead
ages. Geochimica et Cosmochimica Acta, 62(4), pp.665-676.
</p>
<p>Nicolaysen, L.O., 1961. Graphic interpretation of discordant age
measurements on metamorphic rocks. Annals of the New York Academy
of Sciences, 91(1), pp.198-206.
</p>
<p>Titterington, D.M. and Halliday, A.N., 1979. On the fitting of
parallel isochrons and the method of maximum likelihood. Chemical
Geology, 26(3), pp.183-195.
</p>
<p>Vermeesch, P., 2020. Unifying the U-Pb and Th-Pb methods: joint
isochron regression and common Pb correction, Geochronology, 2,
119-131.
</p>
<p>York, D., 1966. Least-squares fitting of a straight line. Canadian
Journal of Physics, 44(5), pp.1079-1086.
</p>
<p>York, D., 1968. Least squares fitting of a straight line with
correlated errors. Earth and Planetary Science Letters, 5,
pp.320-324.
</p>
<p>York, D., Evensen, N.M., Martinez, M.L. and De Basebe Delgado, J., 2004.
Unified equations for the slope, intercept, and standard
errors of the best straight line. American Journal of Physics,
72(3), pp.367-375.
</p>


<h3>See Also</h3>

<p><code>york</code>,
<code>titterington</code>,
<code>ludwig</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">attach(examples)
isochron(RbSr)

fit &lt;- isochron(ArAr,inverse=FALSE,plot=FALSE)

dev.new()
isochron(ThU,type=4)

</code></pre>


</div>