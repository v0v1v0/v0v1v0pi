<div class="container">

<table style="width: 100%;"><tr>
<td>duembgen.shape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Duembgen's Shape Matrix </h2>

<h3>Description</h3>

<p>Iterative algorithm to estimate Duembgen's shape matrix. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">duembgen.shape(X, init = NULL, steps = Inf, eps = 1e-06, 
               maxiter = 100, in.R = FALSE, na.action = na.fail, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric data matrix or dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional matrix giving the starting value for the iteration. Otherwise the regular covariance is used after transforming it to a shape matrix wit determinant 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>a fixed number of iteration steps to take. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p> convergence tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p> maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.R</code></td>
<td>
<p>logical. If TRUE R-code (and not C) is used in the iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a function which indicates what should happen when the data
contain 'NA's.  Default is to fail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other arguments passed on to  <code>tyler.shape</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Duembgen's shape matrix can be seen as <code>tyler.shape</code>'s matrix wrt to the origin for the pairwise differences of the observations.
Therefore this shape matrix needs no location parameter.
</p>
<p>The function is, however, slow if the dataset is large.
</p>
<p>The algorithm also allows for a k-step version where the iteration is run for a fixed number of steps instead of until convergence. If <code>steps</code> is finite that number of steps is taken and <code>maxiter</code> is ignored.
</p>
<p>A better implementation is available in the package fastM as the function <code>DUEMBGENshape</code>.
</p>


<h3>Value</h3>

<p>A matrix.
</p>


<h3>Author(s)</h3>

<p>Klaus Nordhausen, Seija Sirkia, and some of the C++ is based on work by Jari Miettinen</p>


<h3>References</h3>

<p><cite>Duembgen, L. (1998), On Tyler's M-functional of scatter in high dimension, <em>Annals of Institute of Statistical Mathematics</em>, <b>50</b>,  471â€“491. </cite>  
</p>


<h3>See Also</h3>

 <p><code>tyler.shape</code>, <code>duembgen.shape.wt</code></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(654321)
cov.matrix &lt;- matrix(c(3,2,1,2,4,-0.5,1,-0.5,2), ncol=3)
X &lt;- rmvnorm(100, c(0,0,0), cov.matrix)
cov.matrix/det(cov.matrix)^(1/3)
duembgen.shape(X)
rm(.Random.seed)
</code></pre>


</div>