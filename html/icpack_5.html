<div class="container">

<table style="width: 100%;"><tr>
<td>fitit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit proportional hazard model with smooth baseline hazard and (optional) interval censoring</h2>

<h3>Description</h3>

<p>Fit proportional hazard model with smooth baseline hazard and (optional) interval censoring
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitit(
  Y,
  R,
  dead,
  X,
  B,
  Ic,
  R1,
  cbx,
  Pdiff,
  Pridge,
  lambda,
  nit = 50,
  tol = 1e-06,
  tollam = 0.01,
  update_lambda = FALSE,
  ic_update = TRUE,
  monitor = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Events (matrix, number of bins by subjects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Risk sets (matrix, number of bins by subjects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dead</code></td>
<td>
<p>(Boolean vector, TRUE if event, FALSE if right censored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariates (matrix, number of covariates (+1) by subjects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>B-spline basis matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ic</code></td>
<td>
<p>Censoring interval per individual, coded as 0/1 (in columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R1</code></td>
<td>
<p>Left truncation interval per individual, coded as 0/1 (in columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cbx</code></td>
<td>
<p>Vector of starting values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pdiff</code></td>
<td>
<p>B-spline part of penalty matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pridge</code></td>
<td>
<p>Ridge part of penalty matrix (for intercept)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Smoothing parameter (number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit</code></td>
<td>
<p>Maximum number of iterations (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance for final fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tollam</code></td>
<td>
<p>Tolerance for switching to lambda update</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_lambda</code></td>
<td>
<p>Automatic update of lambda (Boolean)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic_update</code></td>
<td>
<p>Update risk and event probabilities (Boolean)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>
<p>Monitor convergence (Boolean)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cbx</code></td>
<td>
<p>Vector of </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>Poisson GLM log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Final tuning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>Penalty part of penalized log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ed</code></td>
<td>
<p>Effetive dimension of the baseline hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit1</code></td>
<td>
<p>Number of iterations used in first phase</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit</code></td>
<td>
<p>Total number of iterations used (first plus second phase)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tollam</code></td>
<td>
<p>Tolerance used for switching to lambda update</p>
</td>
</tr>
</table>
</div>