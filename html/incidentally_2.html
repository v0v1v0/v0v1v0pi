<div class="container">

<table style="width: 100%;"><tr>
<td>curveball</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomize an incidence matrix or bipartite graph using the curveball algorithm</h2>

<h3>Description</h3>

<p><code>curveball</code> randomizes an incidence matrix or bipartite graph, preserving the row and column sums
</p>


<h3>Usage</h3>

<pre><code class="language-R">curveball(M, trades = 5 * nrow(M), class = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a binary matrix of class <code>matrix</code> or <code>Matrix</code>, or a bipartite graph of class igraph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trades</code></td>
<td>
<p>integer: number of trades; the default is 5 * nrow(M) (approx. mixing time)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>string: Return object as <code>matrix</code>, <code>Matrix</code>, <code>igraph</code>. If <code>NULL</code>, object is returned in the same class as <code>M</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Strona et al. (2014) provided an initial implementation of the Curveball algorithm in R. <code>curveball()</code> is a modified R
implementation that is slightly more efficient. For an even more efficient algorithm, see <code>backbone::fastball()</code>.
</p>


<h3>Value</h3>

<p>An incidence matrix of class <code>matrix</code> or <code>Matrix</code>, or a bipartite graph of class igraph.
</p>


<h3>References</h3>

<p>Strona, Giovanni, Domenico Nappo, Francesco Boccacci, Simone Fattorini, and Jesus San-Miguel-Ayanz. 2014. A Fast and Unbiased Procedure to Randomize Ecological Binary Matrices with Fixed Row and Column Totals. <em>Nature Communications, 5</em>, 4114. doi: <a href="https://doi.org/10.1038/ncomms5114">10.1038/ncomms5114</a>
</p>
<p>Godard, Karl and Neal, Zachary P. 2022. fastball: A fast algorithm to sample bipartite graphs with fixed degree sequences. <a href="https://arxiv.org/abs/2112.04017"><em>arXiv:2112.04017</em></a>
</p>
<p>Neal, Z. P. 2022. incidentally: An R package to generate incidence matrices and bipartite graphs. <em>OSF Preprints</em> doi: <a href="https://doi.org/10.31219/osf.io/ectms">10.31219/osf.io/ectms</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- incidence.from.probability(5,5,.5)  #A matrix
Mrand &lt;- curveball(M)  #Random matrix with same row/col sums
all.equal(rowSums(M), rowSums(curveball(M)))
all.equal(colSums(M), colSums(curveball(M)))
</code></pre>


</div>