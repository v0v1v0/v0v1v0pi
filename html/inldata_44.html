<div class="container">

<table style="width: 100%;"><tr>
<td>samples</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discrete Sample Data</h2>

<h3>Description</h3>

<p>Water-quality information for both groundwater and surface water
collected from monitoring stations in and around the Idaho National Laboratory, Idaho.
The water samples were collected in the field and analyzed in a laboratory to obtain water-quality data.
The dataset was obtained from the National Water Information System (NWIS),
which is maintained by the U.S. Geological Survey.
The NWIS is a comprehensive and distributed application that supports the acquisition,
processing, and long-term storage of water data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">samples
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt><code>site_nm</code></dt>
<dd>
<p>Local site name.</p>
</dd>
<dt><code>sample_dt</code></dt>
<dd>
<p>Date and time the sample was collected, in "America/Denver" time zone.
Missing values of time were substituted with "12:00".</p>
</dd>
<dt><code>parm_short_nm</code></dt>
<dd>
<p>Parameter short name assigned by the USGS, such as "pH".</p>
</dd>
<dt><code>unit_cd</code></dt>
<dd>
<p>Units of measurement, see <code>units</code> dataset for unit descriptions.</p>
</dd>
<dt><code>remark_cd</code></dt>
<dd>
<p>Remark code (result level) used to qualify the parameter value.
The codes and their meanings are as follows:
NA (missing value) is a quantified value;
"&lt;" is where the actual value is known to be less than the value reported,
that is, the measured concentration is below the reporting limit (RL)
and represented as a censored (or nondetection) value.
For censored values, the value reported is the RL;
"E" is an estimated value, that is, the actual value is greater than the minimum detection limit (MDL)
and less than the laboratory reporting level (LRL);
"R" is a nondetect, result less than sample-specific critical level; and
"U" is a material specifically analyzed for but not detected.</p>
</dd>
<dt><code>result_va</code></dt>
<dd>
<p>Parameter value.</p>
</dd>
<dt><code>lab_sd_va</code></dt>
<dd>
<p>Laboratory standard deviation (SD).
For radiochemical data, SD is typically determined from the counting error.
Prior to January 1, 2008, counting error was reported as two SD (Bartholomay and others, 2020, p. 27),
therefore, these values were divided by 2.</p>
</dd>
<dt><code>lab_li_va</code></dt>
<dd>
<p>Lower confidence interval of the <code>result</code> value based on laboratory analysis.</p>
</dd>
<dt><code>lab_ui_va</code></dt>
<dd>
<p>Upper confidence interval of the <code>result</code> value based on laboratory analysis.
In cases where the upper and lower limits are identical, the parameter is expressed as an exact value.</p>
</dd>
<dt><code>rpt_lev_va</code></dt>
<dd>
<p>Laboratory reporting limit in effect for the parameter and
analytical method at the time the measurement was made.</p>
</dd>
<dt><code>rpt_lev_cd</code></dt>
<dd>
<p>Reporting level code that identifies the analytical reporting level
appropriate for the analytical method.
The codes and their meanings are as follows:
"DLBLK" detection limit by blank data;
"DLDQC" detection limit by DQCALC, lowest concentration that with 90 percent confidence will be
exceeded no more than 1 percent of the time when a blank sample is measured;
"IRL" interim reporting level, a temporary reporting level;
"LRL" laboratory reporting level, equal to twice the yearly-determined LT-MDL;
"LT-MDL" long-term method detection limit,
a detection level derived by determining the standard deviation of
a minimum of 24 MDL spike sample measurements over an extended period of time;
"MDL" method detection limit, minimum concentration of a substance that can be measured
and reported with a 99 percent confidence that the analyte concentration is greater than zero;
"PQL" practical quantitation limits;
"MRL" minimum reporting level, smallest measured concentration that can be reliably measured using
a given analytical method;
"RLDQC" reporting limit by DQCALC, is greater than or equal to two times the DLDQC;
"SSLC" sample-specific critical level, the calculated and reported value is below
which the radiochemistry result is considered a non-detect; and
"SSMDC" sample-specific minimum detectable concentration, a reporting level that varies
for each sample and is primarily used in radiochemical analyses.</p>
</dd>
<dt><code>medium_cd</code></dt>
<dd>
<p>Medium code that identifies the material type
and quality assurance type of the sample.
The codes and their meanings are as follows:
"OAQ" is a blank sample collected for QC purposes;
"WG" is water below land surface contained in the saturated zone (groundwater);
"WGQ" is a groundwater quality-control (QC) sample;
"WS" is water on the surface of the Earth (surface water); and
"WSQ" surface water QC sample.</p>
</dd>
<dt><code>anl_ent_cd</code></dt>
<dd>
<p>Analyzing entity code of the organizational unit that
performed the sample analysis used to obtain the result.</p>
</dd>
<dt><code>dqi_cd</code></dt>
<dd>
<p>Data quality indicator code that indicates the review status of a result.
The codes and their meanings are as follows:
"A" historical data,
"R" reviewed and accepted, and
"S" provisional (presumed satisfactory).</p>
</dd>
<dt><code>meth_cd</code></dt>
<dd>
<p>Method code, the codes are documented in the NWIS Method Code Dictionary.</p>
</dd>
<dt><code>sample_type_cd</code></dt>
<dd>
<p>Sample type code that identifies the quality-assurance (QA) type of a sample.
The codes and their meanings are as follows:
"2" is a blank sample;
"6" is a reference material sample;
"7" is a replicate sample taken from the environment;
"9" is a regular sample taken from the environment;
"B" is a unspecified QA sample; and
"H" is a composite (time) sample.</p>
</dd>
<dt><code>db_no</code></dt>
<dd>
<p>2-digit NWIS database number.
The codes and their meanings are as follows:
"01" is the environmental database, and
"10" is the QA database.</p>
</dd>
<dt><code>sample_id</code></dt>
<dd>
<p>Unique identifier for the water sample.
The sample code is a concatenation of the site number, medium code, and date-time the sample was collected.</p>
</dd>
<dt><code>site_no</code></dt>
<dd>
<p>USGS site identification number.</p>
</dd>
<dt><code>pcode</code></dt>
<dd>
<p>USGS 5-digit parameter code.
For example, the parameter code for Tritium is "07000".</p>
</dd>
<dt><code>rep_pair_id</code></dt>
<dd>
<p>Unique identifier used for matching pairs of replicate samples for a specific parameter.
Replicate pairs are identified by matching a replicate sample (<code>sample_type_cd</code> equal to 7) with
its corresponding regular environmental sample (<code>sample_type_cd</code> equal to 9).</p>
</dd>
<dt><code>result_tx</code></dt>
<dd>
<p>Remark about the water quality result</p>
</dd>
<dt><code>remark</code></dt>
<dd>
<p>Remarks pertaining to changes applied after the records were obtained from NWIS.</p>
</dd>
<dt><code>anl_dt</code></dt>
<dd>
<p>Result analysis date.</p>
</dd>
</dl>
<h3>Source</h3>

<p>Data were obtained from the NWIS-QWDATA database on January 22, 2024,
in tab-delimited output-format using the QWDATA system (U.S. Geological Survey, 2024).
The following steps were taken to process the data:
</p>

<ul>
<li> <p><strong>Column Name Translation:</strong> Column names were switched from NWIS alpha codes to NWIS parameter codes.
</p>
</li>
<li> <p><strong>Class Conversion:</strong> Classes for each column were converted to the appropriate type (numeric, POSIX, factor).
</p>
</li>
<li> <p><strong>Column Removal:</strong> Unnecessary columns were removed.
</p>
</li>
<li> <p><strong>Duplicate Removal:</strong> Duplicate records in the NWIS and QWDATA databases were removed.
</p>
</li>
<li> <p><strong>Data Cleaning:</strong> Corrupted results were removed.
A column was added for data processing remarks.
Zero and negative results were reported as nondetects.
</p>
</li>
<li> <p><strong>Radiochemical Parameter Identification:</strong> Radiochemical parameter codes were identified.
Nondetects were reported as less than the reporting level.
</p>
</li>
<li> <p><strong>Sample Type Reporting:</strong> In the absence of a sample type code,
results were classified as environmental samples.
Data from blank, spiked, and reference samples,
as well as composite samples (collected over a period of time), were excluded.
</p>
</li>
<li> <p><strong>Sample Identifier Creation:</strong> Site number and date/time were combined to create a unique sample identifier.
</p>
</li>
<li> <p><strong>Error Conversion:</strong> Counting error was converted to laboratory standard deviation.
Data entered into NWIS with an uncertainty of twice the standard deviation (data entered before 2008),
were converted to one standard deviation.
</p>
</li>
<li> <p><strong>Record Removal:</strong> Records associated with counting error parameter codes were removed.
</p>
</li>
<li> <p><strong>Replicate Pairing:</strong> Replicate samples were paired based on the
parameter code, site number, and time difference between sample collection.
</p>
</li>
<li> <p><strong>Data Adjustment:</strong> The detection limit, left-censored values, and non-positive lower limit were accounted for.
Interval censored data were represented using upper and lower limits of the
95-percent confidence interval of the parameter value.
</p>
</li>
</ul>
<h3>References</h3>

<p>Bartholomay, R.C., Maimer, N.V., Rattray, G.W., and Fisher, J.C., 2020,
An update of hydrologic conditions and distribution of selected constituents in water,
Eastern Snake River Plain Aquifer and perched groundwater zones, Idaho National Laboratory,
Idaho, emphasis 2016-18:
U.S. Geological Survey Scientific Investigations Report 2019-5149 (DOE/ID-22251), 82 p.,
<a href="https://doi.org/10.3133/sir20195149">doi:10.3133/sir20195149</a>.
</p>
<p>U.S. Geological Survey, 2024, National Water Information Systemâ€”Water-Quality System (QWDATA)
data retrieval program.
</p>


<h3>Examples</h3>

<pre><code class="language-R">str(samples)

poi &lt;- as.POSIXct(c("1989-01-01", "2019-01-01")) # period of interest
is_poi &lt;- samples$sample_dt &gt;= poi[1] &amp; samples$sample_dt &lt; poi[2]
is_stc &lt;- samples$sample_type_cd %in% c("7", "9")

site_no &lt;- "433253112545901" # well USGS 20
pcode &lt;- "07000" # tritium, water, unfiltered, picocuries per liter
is &lt;- is_poi &amp; is_stc &amp; samples$site_no == site_no &amp; samples$pcode == pcode
d &lt;- samples[is, ]
plotrix::plotCI(
  x = d$sample_dt,
  y = d$result_va,
  li = d$lab_li_va,
  ui = d$lab_ui_va
)

site_no &lt;- "433322112564301" # well USGS 38
pcode &lt;- "01030" # chromium, water, filtered, micrograms per liter
is &lt;- is_poi &amp; is_stc &amp; samples$site_no == site_no &amp; samples$pcode == pcode
d &lt;- samples[is, ]
plotrix::plotCI(
  x = d$sample_dt,
  y = d$result_va,
  li = d$lab_li_va,
  ui = d$lab_ui_va
)
</code></pre>


</div>