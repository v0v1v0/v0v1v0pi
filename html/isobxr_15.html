<div class="container">

<table style="width: 100%;"><tr>
<td>fit.final_space</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit n parameters to observations</h2>

<h3>Description</h3>

<p>A function to find the combinations of values of n parameters
producing final state delta values fitting within confidence intervals of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.final_space(
  workdir,
  obs_file_name,
  sweep_space_digest_folders,
  fit_name = NULL,
  output_dir = NULL,
  delta_reference_box = NaN,
  excluded_boxes = NULL,
  print_correlogram = FALSE,
  print_lda = FALSE,
  print_LS_surfaces = FALSE,
  parameter_subsets = NULL,
  custom_expressions = NULL,
  save_outputs = FALSE,
  export_fit_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>workdir</code></td>
<td>
<p>Working directory of <strong><em>0_ISOBXR_MASTER.xlsx</em></strong> master file, <br>
of the dynamic sweep master file (e.g., <strong><em>0_EXPLO_DYN_MASTER.xlsx</em></strong>) <br>
and where output files will be stored if saved by user. <br>
(character string)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_file_name</code></td>
<td>
<p>Name of csv file containing observations with csv extension. <br>
Stored in workdir. Example: "observations.csv" <br>
Should contain the following columns: <br></p>

<ol>
<li> <p><strong>BOX_ID</strong>: BOX ID (e.g., A, OCEAN...) as defined in isobxr master file.
</p>
</li>
<li> <p><strong>delta.def</strong> definition of delta value, e.g., d18O
</p>
</li>
<li> <p><strong>delta.ref</strong> BOX_ID of reservoir used as a reference.
</p>
</li>
<li> <p><strong>obs.delta</strong> average observed delta numerical value
</p>
</li>
<li> <p><strong>obs.CI</strong> confidence interval of delta value
</p>
</li>
<li> <p><strong>obs.CI.def</strong> definition of confidence interval, e.g., 95
</p>
</li>
<li> <p><strong>obs.file</strong> name of data source file
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sweep_space_digest_folders</code></td>
<td>
<p>Name of sweep.final_nD digest directory. <br>
Should start with "4_FINnD" and end with "_digest"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_name</code></td>
<td>
<p>Name given to specific fit. If NULL,
output are named after date and time of fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>Destination directory for fit outputs. If NULL, outputs are stored in
sweep_space_digest_folders directory. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_reference_box</code></td>
<td>
<p>BOX ID of reference box, used to calculate difference
between any box delta and reference box delta. Default is NaN. <br>
delta_reference_box should match at least one of the values declared
in the delta.ref column of observation csv file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excluded_boxes</code></td>
<td>
<p>list of boxes to exclude from fit. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_correlogram</code></td>
<td>
<p>If TRUE, includes correlograms to final report when applicable. <br>
Default is FALSE. <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_lda</code></td>
<td>
<p>If TRUE, includes linear discriminant analysis to final report
when applicable. <br>
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_LS_surfaces</code></td>
<td>
<p>If TRUE, includes surfaces of least squarred residuals
to final report when applicable. <br>
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter_subsets</code></td>
<td>
<p>List of limits vectors for parameters to subset before fit. <br>
For instance: list(swp.A.A_B = c(1, 1.00001))
to subset the swept fractionation factor from box A to B between 1 and 1.00001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_expressions</code></td>
<td>
<p>Vector of expressions to add to the list of fitted parameters. <br>
For instance: c("m0.A/f.A_B") to add the ratios of mass of A over A to B flux
to the list of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br>
By default, run outputs are stored in a temporary directory and erased if not saved.
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export_fit_data</code></td>
<td>
<p>If TRUE, exports fitted data as csv and rds files.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A observation fit graphical report, in R session or exported as pdf, and a data report as R list or xlsx if required.
</p>


</div>