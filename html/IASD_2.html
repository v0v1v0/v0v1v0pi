<div class="container">

<table style="width: 100%;"><tr>
<td>IASD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Model Selection for Index of Asymmetry Distribution
</h2>

<h3>Description</h3>

<p>Calculate AIC's and AICc's of unimodal model (one normal distribution) and bimodal model(a mixture of two normal distributions) which fit the distribution of indices of asymmetry (IAS), and plot their density, to help determine IAS distribution is unimodal or bimodal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IASD(df, dfCols = NA, fixSignApproximation = FALSE, 
	plotGraph = TRUE, plotToScreen = FALSE, filePrefix = NA, 
	xlimMin = NA, xlimMax = NA, ylimMin = 0, ylimMax = NA, 
	dHist = NA, dFunc = NA, meanStartSymmetric = NA, 
	sdStartSymmetric = NA, meanStartAsymmetric = NA, 
	sdStartAsymmetric = NA, positiveRatioStartAsymmetric = NA, 
	plotSelect = rep(TRUE, 4), showLegend = TRUE, 
	modelName = c("FA", "DA", "AS", "Skewed AS"), xlab = NA, 
	ylab = NA, main = NA, freqAxis = FALSE, lineColor = "black", 
	nsmall = 2, fileType = "TEXT", generateFiles = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>data frame containing the data to be investigated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfCols</code></td>
<td>

<p>Columns in df to be processed.  If NA, they are from the second to the last columns for multi-column data frame and the sole column for single-column data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixSignApproximation</code></td>
<td>

<p>If TRUE, parameters of normal distributions are determined only by using absolute values, rather than MLE.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotGraph</code></td>
<td>

<p>If TRUE, histograms and density plots are plotted and saved to PDF, if FALSE, they are not plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotToScreen</code></td>
<td>

<p>If TRUE, plotted graphs are also shown in the screen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filePrefix</code></td>
<td>

<p>File names of saved plots and AIC, AICc table files start with this value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlimMin</code></td>
<td>

<p>Minimum of plot range.  If NA, it is determined from the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlimMax</code></td>
<td>

<p>Maximum of plot range.  If NA, it is determined from the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dHist</code></td>
<td>

<p>Width of histogram bars.  If NA, it is one 20th of the plot range.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dFunc</code></td>
<td>

<p>Broken line step for the plot of density functions.  If NA, it is one 200th of the plot range.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimMin</code></td>
<td>

<p>Minimum of vertical axis of plots.  If NA, it is determined by "hist()" function of R.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimMax</code></td>
<td>

<p>Maximum of vertical axis of plots.  If NA, it is determined by "hist()" function of R.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanStartSymmetric</code></td>
<td>

<p>Start value of mean for mle() in bimodal symmetric model.  If NA, it is calculated by using absolute values of the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdStartSymmetric</code></td>
<td>

<p>Start value of sd for mle() in bimodal symmetric model.  If NA, it is calculated by using absolute values of the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanStartAsymmetric</code></td>
<td>

<p>Start value of mean for mle() in bimodal asymmetric model.  If NA, it is calculated by using absolute values of the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdStartAsymmetric</code></td>
<td>

<p>Start value of sd for mle() in bimodal asymmetric model.  If NA, it is calculated by using absolute values of the data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positiveRatioStartAsymmetric</code></td>
<td>

<p>Start value of positiveRatio for mle() in bimodal asymmetric model.  If NA, it is ratio of positive data.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotSelect</code></td>
<td>

<p>Indicate which model's density graph is plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showLegend</code></td>
<td>

<p>If TRUE, legend of the graph is drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelName</code></td>
<td>

<p>Name of four models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Label of x axis.  If NA, name of column is used.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Label of y axis.  If NA, "Density" is used.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Title of graph.  If NA, "Histogram of (column name)" is used.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqAxis</code></td>
<td>

<p>If TRUE axis for frequency is drawn on right.  Each column can be separately controlled by using vector value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineColor</code></td>
<td>

<p>Color of density graphs.  Four density graphs can be separately controlled by using vector value.  If first two color are same, line pattern changes for each density graph.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsmall</code></td>
<td>

<p>The number of digits to the right of decimal points for AIC and AICc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileType</code></td>
<td>

<p>Type of output files for calculation results of AIC and AICc.  If "TEXT", output files are tab separated text file.  If "CSV", they are CSV file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generateFiles</code></td>
<td>

<p>Do not use this option.  If generateFiles is FALSE, no files are generated.  This option is to avoid strict check of CRAN.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters are passed to hist() function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculate AIC and AICc for the following four models and plot their densities.
</p>

<ol>
<li>
<p> unimodal symmetric distribution (normal distribution with mean = 0)<br>
N(0, sd^2) 
</p>
</li>
<li>
<p> unimodal asymmetric distribution (normal distribution)<br>
N(mean, sd^2)
</p>
</li>
<li>
<p> bimodal symmetric distribution (mixture of two normal distributions with opposite sign of mean but same absolute values and weights)<br>
0.5*N(mean, sd^2) + 0.5*N(- mean, sd^2)
</p>
</li>
<li>
<p> bimodal asymmetric distribution (weighted mixture of two normal distributions with opposite sign of mean and the same absolute values)<br>
positiveRatio*N(mean, sd^2) + (1 - positiveRatio)*N(- mean, sd^2)
</p>
</li>
</ol>
<p>Tables of AIC and AICc are saved  as tab separated text file or CSV file, depending of fileType argument.  Histogram and model densities plot are saved for each column.
</p>
<p>If the start values for mle() (meanStartSymmetric, sdStartSymmetric, meanStartAsymmetric, sdStartAsymmetric, positiveRatioStartAsymmetric) are inappropriate values, mle() does not work properly.  If they are not assigned (NA), mean and sd are those of absolute values of the data, and positiveRatio is the ratio of positive data.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>AIC (Akaike's information criterion)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc</code></td>
<td>
<p>AICc (AIC with a correction for finite sample sizes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelName[1]</code></td>
<td>
<p>list for the unimodal symmetric model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelName[2]</code></td>
<td>
<p>list for the unimodal asymmetric model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelName[3]</code></td>
<td>
<p>list for the bimodal symmetric model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelName[4]</code></td>
<td>
<p>list for the bimodal asymmetric model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>estimated value of mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>estimated value of sd</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positiveRatio</code></td>
<td>
<p>estimated value of positiveRatio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>density function</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Satoshi Takahashi
</p>


<h3>Examples</h3>

<pre><code class="language-R">	df = data.frame(ID = c(1:5), IAS = c(8.3, 12.7, -12.7, -7.3, -8.1),
	   IAS2 = c(14.2, 8.8, -12.7, -8.6, -10.5),
	   IAS3 = c(1.04, 1.28, -0.78, -0.84, -0.85))
		# Do not use the option 'generateFiles = FALSE', in the following IASD commands.
	result = IASD(df, generateFiles = FALSE) # calculate AIC's and AICc's
	result = IASD(df, cols = c(2,4), plotGraph = FALSE, generateFiles = FALSE) 
		# use data in the second and fourth columns, do not plot graphs
	result = IASD(df, filePrefix="P.microlepis", xlimMin = -15, 
		xlimMax = 15, dHist = c(1, 1, 0.1), generateFiles = FALSE)  
		# file name of each plot starts with "P.microlepis", plot range 
		# and width of histgram bar is changed
</code></pre>


</div>