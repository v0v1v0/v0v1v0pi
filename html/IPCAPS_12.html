<div class="container">

<table style="width: 100%;"><tr>
<td>ipcaps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform unsupervised clustering to capture population structure based on iterative pruning</h2>

<h3>Description</h3>

<p>This version supports ordinal data which can be applied directly
to SNP data to identify fine-scale population structure. It was built on the
iterative pruning Principal Component Analysis (ipPCA) algorithm
(Intarapanich et al., 2009; Limpiti et al., 2011). The IPCAPS involves an
iterative process using multiple splits based on multivariate Gaussian
mixture modeling of principal components and Clustering EM estimation (Lebret
et al., 2015). In each iteration, rough clusters and outliers are also
identified using our own method called rubikclust (R package <span class="pkg">KRIS</span>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ipcaps(
  bed = NA,
  rdata = NA,
  files = NA,
  label.file = NA,
  lab.col = 1,
  out,
  plot.as.pdf = FALSE,
  method = "mix",
  missing = NA,
  covariate = NA,
  cov.col.first = NA,
  cov.col.last = NA,
  threshold = 0.18,
  min.fst = 8e-04,
  min.in.group = 20,
  no.plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bed</code></td>
<td>
<p>A PLINK binary format consists of 3 files; bed, bim, and fam. To
generate these files from PLINK, use option â€“make-bed. See more details at:
<a href="http://zzz.bwh.harvard.edu/plink/data.shtml">http://zzz.bwh.harvard.edu/plink/data.shtml</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdata</code></td>
<td>
<p>In case of re-analysis, it is convenient to run IPCAPS using the
file rawdata.RData generated by IPCAPS. This file contains a matrix of SNPs
(raw.data) and a vector of labels (label).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>files</code></td>
<td>
<p>IPCAPS supports SNPs encoded as 0, 1 and 2 (dosage encoding).
Rows represent SNPs and columns represent subjects. Each column needs to be
separated by a space or a tab. A big text file should be divided into smaller
files to load faster. For instance, to input 3 files, use as: files=c(
'input1.txt', 'input2.txt', 'input3.txt').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.file</code></td>
<td>
<p>An additional useful information (called "labels" in
IPCAPS) related subject, for example, geographic location or disease
phenotype. These labels (one at a time) are used in displaying the clustering
outcome of IPCAPS. A label file must contain at least one column. However,
it may contain more than one column in which case each column need to be
separated by a space or a tab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.col</code></td>
<td>
<p>The label in the label file to be used in the tree-like
display of IPCAPS clustering results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>To set an absolute path for IPCAPS output. If the specified output
directory already exists, result files are saved in sub-directories
cluster_out, cluster_out1, cluster_out2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.as.pdf</code></td>
<td>
<p>To export plots as PDF. When omitted, plots are saved as PNG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The internal clustering method. It can be set to "mix"
(rubikclust &amp; mixmod), "mixmod" (Lebret et al., 2015), "clara" (R: Clustering
Large Applications), "pam" (R: Partitioning Around Medoids (PAM) Object),
"meanshift" (Wang, 2016), "apcluster" (Bodenhofer et al., 2016), and "hclust"
(R: Hierarchical Clustering). Default = "mix".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>Symbol used for missing genotypes. Default = NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>A file of covariates; one covariate per column. SNPs can be
adjusted for these covariates via regression modeling and residual
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.col.first</code></td>
<td>
<p>Refer to a covariate file, the first covariate to be
considered as confounding variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.col.last</code></td>
<td>
<p>Refer to a covariate file, the last covariate to be
considered as confounding variable. All the variables in between the
cov.col.first and cov.col.last will be considered in the adjustment process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Cutoff value for EigenFit. Possible values range from 0.03
to 0.18. The smaller, the potentially finer the substructure can be. Default
= 0.18.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.fst</code></td>
<td>
<p>Minimum Fst between a pair of subgroups. Default = 0.0008.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.in.group</code></td>
<td>
<p>Minimum number of individuals to constitute a cluster or
subgroup. Default = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.plot</code></td>
<td>
<p>No plot is generated if this option is TRUE. This option is
useful when the system does not support X Windows in the unix based system.
Default = FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The computational time depends on the number of individuals.
Consequentially, if large data sets are analyzed, it may be necessary first
to split data into smaller files, and then load into computer memory (with
parameter 'files'). Internally, the split files are merged to construct
a com-prehensive matrix.
</p>


<h3>Value</h3>

<p>Returns the list object containing 2 internal objects;
output.dir as class character and cluster as class data.frame. The object
output.dir stores a result directory. The object cluster contains 4 columns,
group, node, label, and row.number. The column group contains the assigned
groups from IPCAPS. The column node contains node numbers in a tree as
illustrated in the HTML result files. The column label contains the given
labels that is set to the parameter label. The column row.number contains
indices to an input data, which is matched to row numbers of input matrix.
All clustering result files are saved in one directory (as specified by out)
containing assigned groups, hierarchical trees of group membership, PC plots,
and binary data for further analysis.
</p>

<ul>
<li> <p><code>$snp</code> is a SNP matrix from BED file.
</p>
</li>
<li> <p><code>$snp.info</code> is a data.frame of SNP information from BIM file.
</p>
</li>
<li> <p><code>$ind.info</code> is a data.frame of individual information from FAM file.
</p>
</li>
</ul>
<p>If function return <code>NULL</code>, it means the input files are not in proper
format.
</p>


<h3>References</h3>

<p>Bodenhofer, U., Palme, J., Melkonian, C., and Kothmeier, A. (2016). apcluster
: Affinity Propagation Clustering. Available at: <a href="https://CRAN.R-project.org/package=apcluster">https://CRAN.R-project.org/package=apcluster</a> (Accessed March 7, 2017).
</p>
<p>Intarapanich, A., Shaw, P. J., Assawamakin, A., Wangkumhang, P., Ngamphiw, C.
, Chaichoompu, K., et al. (2009). Iterative pruning PCA improves resolution
of highly structured populations. BMC Bioinformatics 10, 382. doi:10.1186/
1471-2105-10-382.
</p>
<p>Lebret, R., Iovleff, S., Langrognet, F., Biernacki, C., Celeux, G., and
Govaert, G. (2015). Rmixmod: TheRPackage of the Model-Based Unsupervised,
Supervised, and Semi-Supervised ClassificationMixmodLibrary. J. Stat. Softw.
67. doi:10.18637/jss.v067.i06.
</p>
<p>Limpiti, T., Intarapanich, A., Assawamakin, A., Shaw, P. J., Wangkumhang, P.,
Piriyapongsa, J., et al. (2011). Study of large and highly stratified
population datasets by combining iterative pruning principal component
analysis and structure. BMC Bioinformatics 12, 255. doi:10.1186/1471-2105-12-
255.
</p>
<p>Maechler, M., Rousseeuw, P., Struyf, A., Hubert, M., and Hornik, K. (2017).
cluster: Cluster Analysis Basics and Extensions.
</p>
<p>R: Clustering Large Applications Available at: <a href="https://stat.ethz.ch/R-manual/R-devel/library/cluster/html/clara.html">https://stat.ethz.ch/R-manual/R-devel/library/cluster/html/clara.html</a> (Accessed March 7, 2017).
</p>
<p>R Core Team (2017). R: A Language and Environment for Statistical Computing.
Vienna, Austria: R Foundation for Statistical Computing Available at:
<a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</p>
<p>R: Hierarchical Clustering Available at: <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/hclust.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/hclust.html</a> (Accessed March 7, 2017).
</p>
<p>R: Partitioning Around Medoids (PAM) Object Available at: <a href="https://stat.ethz.ch/R-manual/R-devel/library/cluster/html/pam.object.html">https://stat.ethz.ch/R-manual/R-devel/library/cluster/html/pam.object.html</a> (Accessed
March 7, 2017).
</p>
<p>Wang, M. C. and D. (2016). MeanShift: Clustering via the Mean Shift
Algorithm. Available at: <a href="https://CRAN.R-project.org/package=MeanShift">https://CRAN.R-project.org/package=MeanShift</a>
(Accessed March 7, 2017).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Use the BED format as input
#Importantly, bed file, bim file, and fam file are required
#Use the example files embedded in the package

BED.file &lt;- system.file("extdata", "ipcaps_example.bed", package = "IPCAPS")
LABEL.file &lt;- system.file("extdata", "ipcaps_example_individuals.txt.gz",
                          package = "IPCAPS")
my.cluster1 &lt;- ipcaps(bed = BED.file, label.file = LABEL.file, lab.col = 2,
out = tempdir())

table(my.cluster1$cluster$label, my.cluster1$cluster$group)

# Alternatively, use a text file as input
# Use the example files embedded in the package

#text.file &lt;- system.file("extdata", "ipcaps_example_rowVar_colInd.txt.gz",
#                          package="IPCAPS")
#LABEL.file &lt;- system.file("extdata", "ipcaps_example_individuals.txt.gz",
#                           package="IPCAPS")

#my.cluster2 &lt;- ipcaps(files = c(text.file), label.file = LABEL.file, lab.col = 2,
#                       out=tempdir())
#table(my.cluster2$cluster$label, my.cluster2$cluster$group)

# The other alternative way, use an R Data file as input
# Use the example file embedded in the package

#rdata.file &lt;- system.file("extdata", "ipcaps_example.rda", package = "IPCAPS")

#my.cluster3 &lt;- ipcaps(rdata = rdata.file, out = tempdir())
#table(my.cluster3$cluster$label, my.cluster3$cluster$group)

</code></pre>


</div>