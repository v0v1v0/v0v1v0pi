<div class="container">

<table style="width: 100%;"><tr>
<td>spectral_entropy_similarity_score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Spectral Entropy Calculator
</h2>

<h3>Description</h3>

<p>This module measures similarity of spectral entropies between 'PEAK_A' and 'PEAK_B' fragment spectra using a method described by the reference paper.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectral_entropy_similarity_score(PEAK_A, S_PEAK_A, PEAK_B, S_PEAK_B, massError,
allowedNominalMass = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PEAK_A</code></td>
<td>

<p>A matrix (m/z, int) of fragmentation spectra
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_PEAK_A</code></td>
<td>

<p>Spectral entropy of PEAK_A
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PEAK_B</code></td>
<td>

<p>A matrix (m/z, int) of fragmentation spectra
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_PEAK_B</code></td>
<td>

<p>Spectral entropy of PEAK_B
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massError</code></td>
<td>

<p>Mass accuracy in Da
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowedNominalMass</code></td>
<td>

<p>c(TRUE, FALSE). Select 'TRUE' only for nominal mass analysis.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>spectral entropy similarity between 0 - 1
</p>


<h3>References</h3>

<p>Li, Y., Kind, T., Folz, J., Vaniya, A., Mehta, S.S. and Fiehn, O. (2021). Spectral entropy outperforms MS/MS dot product similarity for small-molecule compound identification. <em>Nature methods</em>, 18(12), 1524-1531, <a href="https://doi.org/10.1038/s41592-021-01331-z">doi:10.1038/s41592-021-01331-z</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">allowedWeightedSpectralEntropy &lt;- TRUE
##
A &lt;- cbind(seq(50, 160, length.out = 10), seq(10, 90, length.out = 10))
sA &lt;- spectral_entropy_calculator(A, allowedWeightedSpectralEntropy)
S_PEAK_A &lt;- sA[[1]]
PEAK_A &lt;- sA[[3]]
##
B &lt;- cbind(seq(50, 160, length.out = 10), seq(50, 60, length.out = 10))
sB &lt;- spectral_entropy_calculator(A, allowedWeightedSpectralEntropy)
S_PEAK_B &lt;- sB[[1]]
PEAK_B &lt;- sB[[3]]
##
allowedNominalMass = TRUE
entropyScore &lt;- spectral_entropy_similarity_score(PEAK_A, S_PEAK_A, PEAK_B,
S_PEAK_B, allowedNominalMass)
</code></pre>


</div>