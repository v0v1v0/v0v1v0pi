<div class="container">

<table style="width: 100%;"><tr>
<td>solve_numerically</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Numerically solve stable isotope box models</h2>

<h3>Description</h3>

<p>A numerical solver of the system of ordinary differential equations (ODES), <br>
describing the evolution of stable isotope ratios in all boxes of a system. <br>
Not intended for manual use. <br>
The numerical solver uses the <strong><em>deSolve::ode</em></strong> function
to integrate the stable isotopes ratios over time in each box. It allows the
calculation of the evolution of stable isotope ratio in the case of
unbalanced outward and inward fluxes of element X in a given box
resulting in the accumulation or loss of element X.
</p>


<h3>Usage</h3>

<pre><code class="language-R">solve_numerically(IN, paths, to_DIGEST_csv = FALSE, return_results = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IN</code></td>
<td>
<p>input data, edited by <code>sim.single_run</code> (list of dataframes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paths</code></td>
<td>
<p>paths object edited by <code>sim.single_run</code> (list of characters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to_DIGEST_csv</code></td>
<td>
<p>if TRUE, edits csv outputs to DIGEST directory <br>
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_results</code></td>
<td>
<p>if TRUE, results returned as a list of R objects. <br>
Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numerically determined evolution of stable isotope compositions <br>
and masses of element X in all boxes over the run duration as specified in INPUT file.
<br><br>
Run outputs are stored in a temporary directory and not exported by <code>solve_numerically</code>.
<br><br>
The outputs of the run are stored in the rds output file in the SERIES directory
with the following file name structure:  <br><strong><em>SERIES_ID + RUN_n.rds</em></strong>
</p>


<h3>Optional csv outputs to DIGEST directory are as follows</h3>


<ol>
<li>
<p> OUT data file storing initial and final size and delta values in all boxes.<br>
(file name structure: <strong><em>out_1_N_OUT + RUN name + .csv</em></strong>)
</p>
</li>
<li>
<p> evS data file storing the evolution with time of the sizes (masses of element X) of all boxes.<br>
(file name structure:  <strong><em>out_2_N_evS + RUN name + .csv</em></strong>)
</p>
</li>
<li>
<p> evD data file storing the evolution with time of the delta values in all boxes.<br>
(file name structure:  <strong><em>out_3_N_evD + RUN name + .csv</em></strong>)
</p>
</li>
</ol>
</div>