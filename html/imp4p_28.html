<div class="container">

<table style="width: 100%;"><tr>
<td>sim.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of data sets by controlling the proportion of MCAR values and the distribution of MNAR values.
</h2>

<h3>Description</h3>

<p>This function simulates data sets similar to MS-based bottom-up proteomic data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
sim.data(nb.pept=15000,nb.miss=5000,pi.mcar=0.2,para=3,nb.cond=1,nb.repbio=3,
nb.sample=3,m.c=25,sd.c=2,sd.rb=0.5,sd.r=0.2)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nb.pept</code></td>
<td>
<p>The number of rows (identified peptides) of the generated data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.miss</code></td>
<td>
<p>The number of missing values to generate in each column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.mcar</code></td>
<td>
<p>The proportion of MCAR values in each column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Parameter used for simulating MNAR values in columns (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.cond</code></td>
<td>
<p>The number of studied biological conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.repbio</code></td>
<td>
<p>The number of biological samples in each condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.sample</code></td>
<td>
<p>The number of samples coming from each biological sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.c</code></td>
<td>
<p>The mean of the average values in each condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.c</code></td>
<td>
<p>The standard deviation of the average values in each condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.rb</code></td>
<td>
<p>The standard deviation of the average values in each biological sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.r</code></td>
<td>
<p>The standard deviation of values in each row among the samples coming from a same biological sample.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First, the average of intensities of a peptide <code>i</code> in a condition is generated by a Gaussian distribution <code class="reqn">m_{cond}\sim N(m.c,sd.c)</code>. Second, the effect of a biological sample is generated by <code class="reqn">m_{bio}\sim N(0,sd.rb)</code>. The value of a peptide <code>i</code> in the sample <code>j</code> belonging to a specific biological sample and a specific condition is finally generated by <code class="reqn">x_{ij}\sim N(m_{cond}+m_{bio},sd.r)</code>.
</p>
<p>Next, the MCAR values are generated in each column by random draws without replacement among the indexes of rows. The MNAR values are generated in the remaining indexes of rows by random draws without replacement and by respecting the following probabilities:
</p>
<p><code class="reqn">P(x_{ij} is MNAR)=1-(x_{ij}-min_i(x_{ij}))/((max_i(x_{ij})-min_i(x_{ij}))*(para))</code>
</p>
<p>where <code class="reqn">para</code> allows adjusting the distribution of MNAR values. If <code class="reqn">para=0</code>, then the MNAR values are uniformly distributed among intensity level. More <code class="reqn">para</code> is high and more the MNAR values arise for small intensity levels and not for high intensity levels.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat.obs</code></td>
<td>
<p>The simulated data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat.comp</code></td>
<td>
<p>The simulated data set without missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list.MCAR</code></td>
<td>
<p>The index of MCAR values among the rows in each column of the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMCAR</code></td>
<td>
<p>The number of MCAR values in each sample (after deleting rows with only generated missing values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nNA</code></td>
<td>
<p>The number of missing values in each sample (after deleting rows with only generated missing values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditions</code></td>
<td>
<p>A vector of factors indicating the biological condition to which each sample belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repbio</code></td>
<td>
<p>A vector of factors indicating the biological sample to which each sample belongs.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Quentin Giai Gianetto &lt;quentin2g@yahoo.fr&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The function can be used as
res.sim=sim.data(nb.pept=2000,nb.miss=600);
## Simulated data matrix
data=res.sim$dat.obs;
## Vector of conditions of membership for each sample
cond=res.sim$conditions;
## Vector of biological sample of membership for each sample
repbio=res.sim$repbio;
## Percentage of generated MCAR values for each sample
pi_mcar=res.sim$nMCAR/res.sim$nNA

</code></pre>


</div>