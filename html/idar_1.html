<div class="container">

<table style="width: 100%;"><tr>
<td>checktree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check Trait and Phylo Data</h2>

<h3>Description</h3>

<p>Checks consistency of names of species in spatial, phylogenetic and traits data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  checktree(tree,  mippp, idar, correct.phylo)
  checktraits(traits, mippp, idar, correct.trait.na, correct.trait)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogenetic tree in <code>phylo</code> format (<span class="pkg">ape</span>) or a phylogenetic covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>A data.frame of traits, or a distance matrix among species (in dist or matrix format) computed on a data.frame of traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mippp</code></td>
<td>
<p>A multitype (a.k.a. multivariate) marked point pattern . An object with the ppp format of <span class="pkg">spatstat</span>, with the names of species as marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idar</code></td>
<td>
<p>Character. The name of the idar fucntion to be computed. Either "isar", "ipsvar", "ipsrar", "ipsear", "ipscar", or "imntdar"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.phylo</code></td>
<td>
<p>Character. Either <code>"mean"</code> meaning <em>"include missing species in the tree with a constant mean phylogenetic covariance"</em> or <code>"exclude"</code>, meaning <em>"exclude missing species in the tree from the analysis"</em> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.trait.na</code></td>
<td>
<p>Logical flag indicating whether <code>NA</code> values in the matrix of traits should be "corrected": NA values will be assigned the mean trait value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.trait</code></td>
<td>
<p>Character. Either <code>"mean"</code> or <code>"exclude"</code>. Species missing in the data.frame of traits will be assigned mean trait values or  will be excluded from the analysis, respectively. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions check for the coincidence of  species in the point pattern and in the phylogenetic or trait data and for the existence of missing data. If <code>correct.phylo="mean"</code>, species which are absent in the phylogenetic tree or covariance matrix will be included and assigned mean phylogenetic covariance. If <code>correct.phylo="exclude"</code>, missing species in the tree will be excluded from the analysis (i.e., will not be considered in the computation of the local phylogenetic indices). If <code>correct.trait.na="TRUE"</code>, NA values for traits in the data.frame of traits will be assigned the mean trait value. If <code>correct.trait="mean"</code>, missing species in the data.frame of traits will be included and assigned mean trait values.  If <code>correct.trait="exclude"</code>, missing species in the data.frame of traits will be excluded from the analysis (i.e., will not be considered in the computation of the local functional indices).
</p>


<h3>Value</h3>

<p><code>checktree</code> returns a covariance matrix with the appropriate species corrections.   <code>checktraits</code> returns a data.frame of traits with the appropriate corrections or a Gower distance matrix among the species from the corrected data.frame of traits if   <code>idar="ifdar"</code>.
</p>


<h3>Warning</h3>

<p>The transcription of species names in the multivariate <code>mippp</code>, in the row names of  the <code>data.frame</code> of traits (or in the names or <code>dimnames</code> of  the distance matrices) should be identical. The same applies to the <code>tiplabels</code> of the phylogenetic tree.
</p>


<h3>Author(s)</h3>

<p> Marcelino de la Cruz <a href="mailto:marcelino.delacruz@urjc.es">marcelino.delacruz@urjc.es</a></p>


</div>