<div class="container">

<table style="width: 100%;"><tr>
<td>run.mnn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run MNN alignment on the main data.</h2>

<h3>Description</h3>

<p>This function takes an object of class iCellR and runs MNN alignment. It's a wrapper for scran.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run.mnn(
  x = NULL,
  method = "base.mean.rank",
  top.rank = 500,
  gene.list = "character",
  data.type = "main",
  k = 20,
  cos.norm = TRUE,
  ndist = 3,
  d = 50,
  approximate = FALSE,
  irlba.args = list(),
  subset.row = NULL,
  auto.order = FALSE,
  pc.input = FALSE,
  compute.variances = FALSE,
  assay.type = "logcounts",
  get.spikes = FALSE,
  BNPARAM = NULL,
  BPPARAM = SerialParam()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class iCellR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Choose from "base.mean.rank" or "gene.model", default is "base.mean.rank". If gene.model is chosen you need to provide gene.list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.rank</code></td>
<td>
<p>A number taking the top genes ranked by base mean, default = 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.list</code></td>
<td>
<p>A charactor vector of genes to be used for PCA. If "clust.method" is set to "gene.model", default = "my_model_genes.txt".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.type</code></td>
<td>
<p>Choose from "main" and "imputed", default = "main"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer scalar specifying the number of nearest neighbors to consider when identifying MNNs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cos.norm</code></td>
<td>
<p>A logical scalar indicating whether cosine normalization should be performed on the input data prior to calculating distances between cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndist</code></td>
<td>
<p>A numeric scalar specifying the threshold beyond which neighbours are to be ignored when computing correction vectors. Each threshold is defined in terms of the number of median distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Number of dimentions to pass to ‘multiBatchPCA’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximate</code></td>
<td>
<p>Further arguments to pass to ‘multiBatchPCA’. Setting ‘approximate=TRUE’ is recommended for large data sets with many cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>irlba.args</code></td>
<td>
<p>Further arguments to pass to ‘multiBatchPCA’. Setting ‘approximate=TRUE’ is recommended for large data sets with many cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset.row</code></td>
<td>
<p>See ‘?"scran-gene-selection"’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto.order</code></td>
<td>
<p>Logical scalar indicating whether re-ordering of batches should be performed to maximize the number of MNN pairs at each step. Alternatively an integer vector containing a permutation of ‘1:N’ where ‘N’ is the number of batches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.input</code></td>
<td>
<p>Logical scalar indicating whether the values in ‘...’ are already low-dimensional, e.g., the output of ‘multiBatchPCA’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.variances</code></td>
<td>
<p>Logical scalar indicating whether the percentage of variance lost due to non-orthogonality should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay.type</code></td>
<td>
<p>A string or integer scalar specifying the assay containing the expression values, if SingleCellExperiment objects are present in ‘...’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get.spikes</code></td>
<td>
<p>See ‘?"scran-gene-selection"’. Only relevant if ‘...’ contains SingleCellExperiment objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BNPARAM</code></td>
<td>
<p>A BiocNeighborParam object specifying the nearest neighbor algorithm. Defaults to an exact algorithm if ‘NULL’, see ‘?findKNN’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BPPARAM</code></td>
<td>
<p>A BiocParallelParam object specifying whether the PCA and nearest-neighbor searches should be parallelized.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class iCellR.
</p>


</div>