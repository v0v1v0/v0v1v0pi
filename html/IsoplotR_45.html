<div class="container">

<table style="width: 100%;"><tr>
<td>cad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot continuous data as cumulative age distributions</h2>

<h3>Description</h3>

<p>Plot a dataset as a Cumulative Age Distribution (CAD), also known
as a ‘empirical cumulative distribution function’.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cad(x, ...)

## Default S3 method:
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'other'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'detritals'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "rainbow",
  hide = NULL,
  ...
)

## S3 method for class 'UPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  type = 4,
  cutoff.76 = 1100,
  cutoff.disc = discfilter(),
  common.Pb = 0,
  hide = NULL,
  ...
)

## S3 method for class 'PbPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  common.Pb = 1,
  hide = NULL,
  ...
)

## S3 method for class 'ArAr'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = FALSE,
  hide = NULL,
  ...
)

## S3 method for class 'KCa'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = FALSE,
  hide = NULL,
  ...
)

## S3 method for class 'ThPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'ThU'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [ka]",
  col = "black",
  Th0i = 0,
  hide = NULL,
  ...
)

## S3 method for class 'ThPb'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'ReOs'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'SmNd'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'RbSr'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'LuHf'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  i2i = TRUE,
  hide = NULL,
  ...
)

## S3 method for class 'UThHe'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)

## S3 method for class 'fissiontracks'
cad(
  x,
  pch = NA,
  verticals = TRUE,
  xlab = "age [Ma]",
  col = "black",
  hide = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numerical vector OR an object of class <code>UPb</code>,
<code>PbPb</code>, <code>ThPb</code>, <code>ArAr</code>, <code>KCa</code>,
<code>UThHe</code>, <code>fissiontracks</code>, <code>ReOs</code>, <code>RbSr</code>,
<code>SmNd</code>, <code>LuHf</code>, <code>ThU</code> or <code>detritals</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plot character to mark the beginning of each CAD step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verticals</code></td>
<td>
<p>logical flag indicating if the horizontal lines of
the CAD should be connected by vertical lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>if <code>x</code> has class <code>detritals</code>, the name of one
of <code>R</code>'s built-in colour palettes (e.g.,
<code>'heat.colors'</code>, <code>'terrain.colors'</code>,
<code>'topo.colors'</code>, <code>'cm.colors'</code>), OR a vector with the
names or codes of two colours to use as the start and end of a
colour ramp (e.g. <code>col=c('yellow','blue')</code>).
</p>
<p>For all other data formats, the name or code for a colour to give
to a single sample dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>scalar indicating whether to plot the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{235}</code>U age (<code>type</code>=1), the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age (<code>type</code>=2), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb age (<code>type</code>=3), the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U age
(<code>type</code>=4), the concordia_age (<code>type</code>=5), or the
<code class="reqn">^{208}</code>Pb/<code class="reqn">^{232}</code>Th age (<code>type</code>=6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.76</code></td>
<td>
<p>the age (in Ma) below which the
<code class="reqn">^{206}</code>Pb/<code class="reqn">^{238}</code>U-age and above which the
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{206}</code>Pb-age is used. This parameter is
only used if <code>type=4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.disc</code></td>
<td>
<p>discordance cutoff filter. This is an object of
class <code>discfilter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common.Pb</code></td>
<td>
<p>common lead correction:
</p>
<p><code>0</code>: none
</p>
<p><code>1</code>: use the Pb-composition stored in
</p>
<p><code>settings('iratio','Pb207Pb206')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format&lt;4</code>);
</p>
<p><code>settings('iratio','Pb206Pb204')</code> and
<code>settings('iratio','Pb207Pb204')</code> (if <code>x</code> has class
<code>PbPb</code> or <code>x</code> has class <code>UPb</code> and
<code>3&lt;x$format&lt;7</code>); or
</p>
<p><code>settings('iratio','Pb206Pb208')</code> and
<code>settings('iratio','Pb207Pb208')</code> (if <code>x</code> has class
<code>UPb</code> and <code>x$format=7</code> or <code>8</code>).
</p>
<p><code>2</code>: use the isochron intercept as the initial Pb-composition
</p>
<p><code>3</code>: use the Stacey-Kramers two-stage model to infer the
initial Pb-composition (only applicable if <code>x</code> has class
<code>UPb</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i2i</code></td>
<td>
<p>‘isochron to intercept’: calculates the initial (aka
‘inherited’, ‘excess’, or ‘common’)
<code class="reqn">^{40}</code>Ar/<code class="reqn">^{36}</code>Ar, <code class="reqn">^{40}</code>Ca/<code class="reqn">^{44}</code>Ca,
<code class="reqn">^{207}</code>Pb/<code class="reqn">^{204}</code>Pb, <code class="reqn">^{87}</code>Sr/<code class="reqn">^{86}</code>Sr,
<code class="reqn">^{143}</code>Nd/<code class="reqn">^{144}</code>Nd, <code class="reqn">^{187}</code>Os/<code class="reqn">^{188}</code>Os,
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th, <code class="reqn">^{176}</code>Hf/<code class="reqn">^{177}</code>Hf or
<code class="reqn">^{204}</code>Pb/<code class="reqn">^{208}</code>Pb ratio from an isochron
fit. Setting <code>i2i</code> to <code>FALSE</code> uses the default values
stored in <code>settings('iratio',...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Th0i</code></td>
<td>
<p>initial <code class="reqn">^{230}</code>Th correction.
</p>
<p><code>0</code>: no correction
</p>
<p><code>1</code>: project the data along an isochron fit
</p>
<p><code>2</code>: if <code>x$format</code> is <code>1</code> or <code>2</code>, correct the
data using the measured present day <code class="reqn">^{230}</code>Th/<code class="reqn">^{238}</code>U,
<code class="reqn">^{232}</code>Th/<code class="reqn">^{238}</code>U and <code class="reqn">^{234}</code>U/<code class="reqn">^{238}</code>U
activity ratios in the detritus. If <code>x$format</code> is <code>3</code> or
<code>4</code>, correct the data using the measured
<code class="reqn">^{238}</code>U/<code class="reqn">^{232}</code>Th activity ratio of the whole rock, as
stored in <code>x</code> by the <code>read.data()</code> function.
</p>
<p><code>3</code>: correct the data using an assumed initial
<code class="reqn">^{230}</code>Th/<code class="reqn">^{232}</code>Th-ratio for the detritus (only relevant
if <code>x$format</code> is <code>1</code> or <code>2</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Empirical cumulative distribution functions or cumulative age
distributions are the most straightforward way to visualise the
probability distribution of multiple dates.  Suppose that we have a
set of <code class="reqn">n</code> dates <code class="reqn">t_i</code>. The CAD is a step function that
sets out the rank order of the dates against their numerical value:
</p>
<p><code class="reqn">CAD(t) = \sum_i 1(t&lt;t_i)/n</code>
</p>
<p>where 1(<code class="reqn">\ast</code>) = 1 if <code class="reqn">\ast</code> is true and 1(<code class="reqn">\ast</code>) = 0
if <code class="reqn">\ast</code> is false. CADs have two desirable properties
(Vermeesch, 2007). First, they do not require any pre-treatment or
smoothing of the data. This is not the case for histograms or
kernel density estimates. Second, it is easy to superimpose several
CADs on the same plot. This facilitates the intercomparison of
multiple samples. The interpretation of CADs is straightforward but
not very intuitive. The prominence of individual age components is
proportional to the steepness of the CAD. This is different from
probability density estimates such as histograms, in which such
components stand out as peaks.
</p>


<h3>References</h3>

<p>Vermeesch, P., 2007. Quantitative geomorphology of the
White Mountains (California) using detrital apatite fission
track thermochronology. Journal of Geophysical Research: Earth
Surface, 112(F3).
</p>


<h3>See Also</h3>

<p><code>kde</code>, <code>radialplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">attach(examples)
cad(DZ,verticals=FALSE,pch=20)
</code></pre>


</div>