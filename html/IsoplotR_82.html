<div class="container">

<table style="width: 100%;"><tr>
<td>helioplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualise U-Th-He data on a logratio plot or ternary diagram</h2>

<h3>Description</h3>

<p>Plot U-Th(-Sm)-He data on a (log[He/Th] vs. log[U/He]) logratio
plot or U-Th-He ternary diagram
</p>


<h3>Usage</h3>

<pre><code class="language-R">helioplot(
  x,
  logratio = TRUE,
  model = 1,
  show.barycentre = TRUE,
  show.numbers = FALSE,
  oerr = 3,
  contour.col = c("white", "red"),
  levels = NA,
  clabel = "",
  ellipse.fill = c("#00FF0080", "#0000FF80"),
  ellipse.stroke = "black",
  sigdig = 2,
  xlim = NA,
  ylim = NA,
  fact = NA,
  hide = NULL,
  omit = NULL,
  omit.fill = NA,
  omit.stroke = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>UThHe</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logratio</code></td>
<td>
<p>Boolean flag indicating whether the data should be
shown on bivariate log[He/Th] vs. log[U/He] diagram, or a
U-Th-He ternary diagram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>choose one of the following statistical models:
</p>
<p><code>1</code>: weighted mean. This model assumes that the scatter between
the data points is solely caused by the analytical uncertainty. If
the assumption is correct, then the MSWD value should be
approximately equal to one. There are three strategies to deal with
the case where MSWD&gt;1. The first of these is to assume that the
analytical uncertainties have been underestimated by a factor
<code class="reqn">\sqrt{MSWD}</code>.
</p>
<p><code>2</code>: unweighted mean. A second way to deal with over- or
underdispersed datasets is to simply ignore the analytical
uncertainties.
</p>
<p><code>3</code>: weighted mean with overdispersion: instead of attributing
any overdispersion (MSWD &gt; 1) to underestimated analytical
uncertainties (model 1), it can also be attributed to the presence
of geological uncertainty, which manifests itself as an added
(co)variance term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.barycentre</code></td>
<td>
<p>show the mean composition as a white
ellipse?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.numbers</code></td>
<td>
<p>show the grain numbers inside the error
ellipses?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oerr</code></td>
<td>
<p>indicates whether the analytical uncertainties of the
output are reported in the plot title as:
</p>
<p><code>1</code>: 1<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>2</code>: 2<code class="reqn">\sigma</code> absolute uncertainties.
</p>
<p><code>3</code>: absolute (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.
</p>
<p><code>4</code>: 1<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>5</code>: 2<code class="reqn">\sigma</code> relative uncertainties (<code class="reqn">\%</code>).
</p>
<p><code>6</code>: relative (1-<code class="reqn">\alpha</code>)% confidence intervals, where
<code class="reqn">\alpha</code> equales the value that is stored in
<code>settings('alpha')</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour.col</code></td>
<td>
<p>two-element vector with the fill colours to be
assigned to the minimum and maximum age contour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a vector with additional values to be displayed as
different background colours within the error ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clabel</code></td>
<td>
<p>label of the colour scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse.fill</code></td>
<td>
<p>Fill colour for the error ellipses. This can either be a single
colour or multiple colours to form a colour ramp. Examples:
</p>
<p>a single colour: <code>rgb(0,1,0,0.5)</code>, <code>'#FF000080'</code>,
<code>'white'</code>, etc.;
</p>
<p>multiple colours: <code>c(rbg(1,0,0,0.5)</code>,
<code>rgb(0,1,0,0.5))</code>, <code>c('#FF000080','#00FF0080')</code>,
<code>c('blue','red')</code>, <code>c('blue','yellow','red')</code>, etc.;
</p>
<p>a colour palette: <code>rainbow(n=100)</code>,
<code>topo.colors(n=100,alpha=0.5)</code>, etc.; or
</p>
<p>a reversed palette: <code>rev(topo.colors(n=100,alpha=0.5))</code>, etc.
</p>
<p>For empty ellipses, set <code>ellipse.fill=NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse.stroke</code></td>
<td>
<p>the stroke colour for the error
ellipses. Follows the same formatting guidelines as
<code>ellipse.fill</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigdig</code></td>
<td>
<p>number of significant digits for the barycentric age</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>optional limits of the x-axis (log[U/He]) of the
logratio plot. If <code>xlim=NA</code>, the axis limits are
determined automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>optional limits of the y-axis (log[Th/He]) of the
logratio plot. If <code>ylim=NA</code>, the axis limits are
determined automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>three-element vector with scaling factors of the
ternary diagram if <code>fact=NA</code>, these will be determined
automatically</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide</code></td>
<td>
<p>vector with indices of aliquots that should be removed
from the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>vector with indices of aliquots that should be plotted
but omitted from the barycentric age calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.fill</code></td>
<td>
<p>fill colour that should be used for the omitted
aliquots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.stroke</code></td>
<td>
<p>stroke colour that should be used for the
omitted aliquots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to the generic <code>plot</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>U, Th, Sm and He are <em>compositional</em> data.  This means that it
is not so much the absolute concentrations of these elements that
bear the chronological information, but rather their relative
proportions. The space of all possible U-Th-He compositions fits
within the constraints of a ternary diagram or ‘helioplot’
(Vermeesch, 2008, 2010). If Sm is included as well, then this
expands to a three-dimensional tetrahaedral space (Vermeesch,
2008).  Data that fit within these constrained spaces must be
subjected to a logratio transformation prior to statistical
analysis (Aitchison, 1986).  In the case of the U-Th-He-(Sm)-He
system, this is achieved by first defining two (or three) new
variables:
</p>
<p><code class="reqn">u \equiv \ln[U/He]</code>
<code class="reqn">v \equiv \ln[Th/He]</code>
<code class="reqn">(, w \equiv \ln[Sm/He] )</code>
</p>
<p>and then performing the desired statistical analysis (averaging,
uncertainty propagation, ...) on the transformed data. Upon
completion of the mathematical operations, the results can then be
mapped back to U-Th-(Sm)-He space using an inverse logratio
transformation:
</p>
<p><code class="reqn">[He] = 1/[e^{u}+e^{v}+(e^{w})+1]</code>,
<code class="reqn">[U] = e^{u}/[e^{u}+e^{v}+(e^{w})+1]</code><br><code class="reqn">[Th] = e^{v}/[e^{u}+e^{v}+(e^{w})+1]</code>,
<code class="reqn">([Sm] = e^{w}/[e^{u}+e^{v}+(e^{w})+1])</code>
</p>
<p>where <code class="reqn">[He] + [U] + [Th] (+ [Sm]) = 1</code>. In the context of
U-Th-(Sm)-He dating, the <em>barycentric</em> age (which is
equivalent to the 'central age' of Vermeesch, 2008) is defined as
the date that corresponds to the compositional mean, which is
equivalent to the arithmetic mean composition in logratio space.
<code>IsoplotR</code>'s <code>helioplot</code> function performs this
calculation using the same algorithm that is used to obtain the
weighted mean U-Pb composition for the <code>concordia</code> age
calculation. Overdispersion is treated similarly as in a regression
context (see <code>isochron</code>).  Thus, there are options to
augment the uncertainties with a factor <code class="reqn">\sqrt{MSWD}</code> (model
1); to ignore the analytical uncertainties altogether (model 2); or
to add a constant overdispersion term to the analytical
uncertainties (model 3).  The <code>helioplot</code> function visualises
U-Th-(Sm)-He data on either a ternary diagram or a bivariate
<code class="reqn">\ln[Th/U]</code> vs. <code class="reqn">\ln[U/He]</code> contour plot. These diagrams
provide a convenient way to simultaneously display the isotopic
composition of samples as well as their chronological meaning. In
this respect, they fulfil the same purpose as the U-Pb
<code>concordia</code> diagram and the U-series
<code>evolution</code> plot.
</p>


<h3>References</h3>

<p>Aitchison, J., 1986, The statistical analysis of
compositional data: London, Chapman and Hall, 416 p.
</p>
<p>Vermeesch, P., 2008. Three new ways to calculate average (U-Th)/He
ages. Chemical Geology, 249(3), pp.339-347.
</p>
<p>Vermeesch, P., 2010. HelioPlot, and the treatment of overdispersed
(U-Th-Sm)/He data. Chemical Geology, 271(3), pp.108-111.
</p>


<h3>See Also</h3>

<p><code>radialplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">attach(examples)
helioplot(UThHe)
dev.new()
helioplot(UThHe,logratio=FALSE)
</code></pre>


</div>