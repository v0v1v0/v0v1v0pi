<div class="container">

<table style="width: 100%;"><tr>
<td>scores_MAP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decompose factor scores by cluster</h2>

<h3>Description</h3>

<p>Takes posterior summaries of the overall factor scores matrix and returns lists of sub-matrices corresponding to the <code>G</code>-cluster MAP partition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scores_MAP(res,
           dropQ = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>An object of class <code>"Results_IMIFA"</code> generated by <code>get_IMIFA_results</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropQ</code></td>
<td>
<p>A logical indicating whether columns of the factor scores matrix should be dropped such that the number of columns in each sub-matrix corresponds to the cluster-specific number of factors (if the number of factors is indeed cluster-specific). When <code>FALSE</code> (the default), the number of columns instead remains common to all sub-matrices - given by the largest of the cluster-specific numbers of latent factors.
</p>
<p>Note that this argument is irrelevant (i.e. always <code>FALSE</code>) for the finite factor methods (<code>"FA"</code>, <code>"MFA"</code>, <code>"OMFA"</code>, and <code>"IMFA"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under the models in the IMIFA family, there exists only one factor scores matrix. For the finite factor methods, this has dimensions <code>N * Q</code>.
</p>
<p>For the infinite factor methods (<code>"IFA"</code>, <code>"MIFA"</code>, <code>"OMIFA"</code>, and <code>"IMIFA"</code>), the factor scores matrix has dimensions <code>N * Qmax</code>, where <code>Qmax</code> is the largest of the cluster-specific numbers of latent factors <code class="reqn">q_1,\ldots,q_g</code>. Entries of this matrix thus may have been padded out with zero entries, as appropriate, prior to the Procrustes rotation-based correction applied within <code>get_IMIFA_results</code> (thus now these entries will be near-zero).
</p>
<p>In partitioning rows of the factor scores matrix into the same clusters the corresponding observations themselves belong to according to the MAP clustering, the number of columns <em>may</em> vary according to the cluster-specific numbers of latent factors (depending on the value of <code>dropQ</code> and the method employed).
</p>


<h3>Value</h3>

<p>For models which achieve clustering, a list of lists (say <code>x</code>) decomposing the posterior mean scores (<code>x$post.eta</code>), the associated variance estimates (<code>x$var.eta</code>) and credible intervals (<code>x$ci.eta</code>), and the last valid sample of the scores (<code>x$last.eta</code>) into lists of length <code>G</code>, corresponding to the MAP clustering, with varying or common numbers of cluster-specific factors (depending on the value of <code>dropQ</code> and the method employed).
</p>
<p>For models with only one component, or the <code>"FA"</code> and <code>"IFA"</code> methods, scores cannot be decomposed, and posterior summaries of the scores will be returned unchanged.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>See Also</h3>

<p><code>get_IMIFA_results</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(coffee)
sim &lt;- mcmc_IMIFA(coffee, n.iters=1000)
res &lt;- get_IMIFA_results(sim)

# Examine the single posterior mean scores matrix
res$Scores$post.eta

# Decompose into G matrices, common numbers of columns
eta &lt;- scores_MAP(res)
eta$post.eta

# Allow the number of columns be cluster-specific
scores_MAP(res, dropQ=TRUE)$post.eta
</code></pre>


</div>