<div class="container">

<table style="width: 100%;"><tr>
<td>get.transdist.theta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get weights of transmission distance theta</h2>

<h3>Description</h3>

<p>This function estimates the weights of each theta (number of transmission events separating cases at two time points). A randomized transmission tree is drawn and the number of transmission events
separating cases at two time points is calculated based on probabilies found in the Wallinga-Teunis matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.transdist.theta(
  wal.teun.mat,
  cases,
  gen.t.mean,
  max.sep,
  ret.theta.mat = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wal.teun.mat</code></td>
<td>
<p>a Wallinga-Teunis matrix produced by the <code>est.wt.matrix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>a vector of case times for each case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen.t.mean</code></td>
<td>
<p>the mean generation time of the infecting pathogen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sep</code></td>
<td>
<p>maximum number of transmission events allowed between two cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.theta.mat</code></td>
<td>
<p>logical value which returns the matrix of estimated theta values (default = FALSE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a three-dimensional array containing normalized theta weights. Columns and rows represent unique case times. The third dimension is the number of transmission events between two cases.
</p>


<h3>Author(s)</h3>

<p>John Giles, Justin Lessler, and Henrik Salje
</p>


<h3>References</h3>

<p>Salje H, Cummings DAT and Lessler J (2016). “Estimating infectious disease transmission distances using the overall distribution of cases.” Epidemics, 17, pp. 10–18. ISSN 1755-4365, doi: <a href="https://www.sciencedirect.com/science/article/pii/S1755436516300317">10.1016/j.epidem.2016.10.001</a>.
</p>


<h3>See Also</h3>

<p>Other transdist: 
<code>est.transdist()</code>,
<code>est.transdist.bootstrap.ci()</code>,
<code>est.transdist.temporal()</code>,
<code>est.transdist.temporal.bootstrap.ci()</code>,
<code>est.transdist.theta.weights()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

case.times &lt;- c(1,2,2,3,3)
gen &lt;- c(0, 2/3, 1/3, 0, 0)
t.density &lt;- gen/sum(gen)

gen.time &lt;- 2 # mean generation time

wt &lt;- est.wt.matrix(case.times=case.times, gen.t.dist=t.density)

ngen &lt;- round((max(case.times) - min(case.times)) / gen.time) + 1 # Number of generations

a &lt;- get.transdist.theta(wal.teun.mat=wt,
                         cases=case.times,
                         gen.t.mean=gen.time,
                         max.sep=ngen*2)


</code></pre>


</div>