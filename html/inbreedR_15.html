<div class="container">

<table style="width: 100%;"><tr>
<td>r2_Wf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected r2 between inbreeding level (f) and fitness (W)</h2>

<h3>Description</h3>

<p>Expected r2 between inbreeding level (f) and fitness (W)
</p>


<h3>Usage</h3>

<pre><code class="language-R">r2_Wf(genotypes, trait, family = "gaussian", type = c("msats", "snps"),
  nboot = NULL, parallel = FALSE, ncores = NULL, CI = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>A <code>data.frame</code> with individuals in rows and loci in columns,
containing genotypes coded as 0 (homozygote), 1 (heterozygote) and <code>NA</code> (missing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>vector of any type which can be specified in R's glm() function. Sequence of individuals has to
match sequence of individuals in the rows of the <code>genotypes</code> <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>distribution of the trait. Default is gaussian. For other distributions, just naming the distribution
(e.g. binomial) will use the default link function (see ?family). Specifying another
link function can be done in the same way as in the glm() function. A binomial distribution with 
probit instead of logit link would be specified with family = binomial(link = "probit")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>specifies g2 formula to take. Type "snps" for large datasets and "msats" for smaller datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstraps over individuals to estimate a confidence interval
around r2(W, f).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Default is FALSE. If TRUE, bootstrapping and permutation tests are parallelized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Specify number of cores to use for parallelization. By default,
all available cores but one are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>confidence interval (default to 0.95)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp_r2_full</code></td>
<td>
<p>expected r2 between inbreeding and sMLH for the full dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2_Wf_boot</code></td>
<td>
<p>expected r2 values from bootstrapping over individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_boot</code></td>
<td>
<p>confidence interval around the expected r2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nloc</code></td>
<td>
<p>number of markers</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin A. Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Slate, J., David, P., Dodds, K. G., Veenvliet, B. A., Glass, B. C., Broad, T. E., &amp; McEwan, J. C. (2004). 
Understanding the relationship between the inbreeding coefficient 
and multilocus heterozygosity: theoretical expectations and empirical data. Heredity, 93(3), 255-265.
</p>
<p>Szulkin, M., Bierne, N., &amp; David, P. (2010). HETEROZYGOSITY-FITNESS CORRELATIONS: A TIME FOR REAPPRAISAL. 
Evolution, 64(5), 1202-1217.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mouse_msats)
data(bodyweight)
genotypes &lt;- convert_raw(mouse_msats)

(out &lt;- r2_Wf(genotypes = genotypes, trait = bodyweight, family = "gaussian", type = "msats",
              nboot = 100, parallel = FALSE, ncores = NULL, CI = 0.95))


</code></pre>


</div>