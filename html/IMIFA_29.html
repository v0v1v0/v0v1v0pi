<div class="container">

<table style="width: 100%;"><tr>
<td>post_conf_mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Confusion Matrix</h2>

<h3>Description</h3>

<p>For a (<code>N * G</code>) matrix of posterior cluster membership probabilities, this function creates a (<code>G * G</code>) posterior confusion matrix, whose hk-th entry gives the average probability that observations with maximum posterior allocation h will be assigned to cluster k.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post_conf_mat(z, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A (<code>N * G</code>) matrix of posterior cluster membership probabilities whose (ig)-th entry gives the posterior probability that observation i belongs to cluster g. Entries must be valid probabilities in the interval [0,1]; missing values are not allowed.
</p>
<p>Otherwise, a list of such matrices can be supplied, where each matrix in the list has the same dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A logical indicator whether the PCM should be rescaled by its row sums. When <code>TRUE</code> (the default), the benchmark matrix for comparison is the identity matrix of order <code>G</code>, corresponding to a situation with no uncertainty in the clustering. When <code>FALSE</code>, the row sums give the number of observations in each cluster.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A (<code>G * G</code>) posterior confusion matrix, whose hk-th entry gives the average probability that observations with maximum posterior allocation h will be assigned to cluster k. When <code>scale=TRUE</code>, the benchmark matrix for comparison is the identity matrix of order <code>G</code>, corresponding to a situation with no uncertainty in the clustering.
</p>


<h3>Author(s)</h3>

<p>Keefe Murphy - &lt;<a href="mailto:keefe.murphy@mu.ie">keefe.murphy@mu.ie</a>&gt;
</p>


<h3>References</h3>

<p>Ranciati, S., Vinciotti, V. and Wit, E., (2017) Identifying overlapping terrorist cells from the Noordin Top actor-event network, <em>Annals of Applied Statistics</em>, 14(3): 1516-1534.
</p>


<h3>See Also</h3>

<p><code>get_IMIFA_results</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data(olive)
# sim  &lt;- mcmc_IMIFA(olive, n.iters=1000)
# res  &lt;- get_IMIFA_results(sim)
# (PCM &lt;- post_conf_mat(res$Clust$post.prob))

# par(mar=c(5.1, 4.1, 4.1, 3.1))
# PCM  &lt;- replace(PCM, PCM == 0, NA)
# plot_cols(mat2cols(PCM, col=heat.colors(30, rev=TRUE), na.col=par()$bg)); box(lwd=2)
# heat_legend(PCM, cols=heat.colors(30, rev=TRUE))
# par(mar=c(5.1, 4.1, 4.1, 2.1))
</code></pre>


</div>