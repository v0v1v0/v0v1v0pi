<div class="container">

<table style="width: 100%;"><tr>
<td>iCARH.simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates longitudinal data based on the iCARH model.</h2>

<h3>Description</h3>

<p>Simulates longitudinal data based on the iCARH model.
Returns two types of datasets with relevant parameters (see below).
</p>


<h3>Usage</h3>

<pre><code class="language-R">iCARH.simulate(
  Tp,
  N,
  J,
  P,
  K,
  path.names = NULL,
  path.probs = FALSE,
  pathway.perturb.ratio = 0.5,
  Ygroupeff = NULL,
  Zgroupeff = NULL,
  fe = 0,
  num.corr.y = 0,
  beta.val = NULL,
  sigma2 = 1,
  arz = 0.7,
  sdx = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>number of time points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of samples (by default first N/2 controls and last N/2 cases)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>number of metabolites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>number of pathways (will probably change)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of bacteria profiles (Y variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.names</code></td>
<td>
<p>pathways to sample from as specified in KEGG. If not specified, path.probs will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.probs</code></td>
<td>
<p>if TRUE, KEGG like density of pathways per metabolite is used to sample from.
If scalar, path.probs is the expected ratio of metabolites in each pathway. Needs to be specified if
path.names is not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway.perturb.ratio</code></td>
<td>
<p>expected ratio of perturbed pathways</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ygroupeff</code></td>
<td>
<p>vector of 2xK variables (treatment effect on Y variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zgroupeff</code></td>
<td>
<p>vector of 2 variables for treatment effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fe</code></td>
<td>
<p>fixed effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.corr.y</code></td>
<td>
<p>number of correlated Y variables. The last num.corr.y will be highly
correlated to the first num.corr.y variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.val</code></td>
<td>
<p>beta values (regression coefficients) to sample from. Values will be randomly sampled if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>individual variance of metabolites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arz</code></td>
<td>
<p>autoregressive coefficient for treatment simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdx</code></td>
<td>
<p>noise for autoregressive process, recommended value is 0.01</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with the following objects :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>XX</code></td>
<td>
<p>metabolomics data, X data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>additional omic data, Y data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>effects of Y variables on X variables, column K+1 represents effect of treatment on X variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathways</code></td>
<td>
<p>pathway adjacency matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.perturb</code></td>
<td>
<p>which pathways are perturbed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>"spatial" dependence parameter, indicative of pathway perturbation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arx</code></td>
<td>
<p>autoregressive coefficients for X data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ary</code></td>
<td>
<p>autoregressive coefficients for Y data</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"> data.sim = iCARH.simulate(4, 8, 10, 2, 2, path.probs=0.3, Zgroupeff=c(0,4),
beta.val=c(1,-1,0.5, -0.5))

</code></pre>


</div>