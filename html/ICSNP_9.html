<div class="container">

<table style="width: 100%;"><tr>
<td>HP1.shape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> One Step Rank Scatter Estimator  </h2>

<h3>Description</h3>

<p>one step M-estimator of the scatter matrix based on ranks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HP1.shape(X, location = "Estimate", na.action = na.fail, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric data frame or matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p> if 'Estimate' the location and scatter matrix used for computing the spatial signs are estimated simultaneously using <code>HR.Mest</code>,
if 'Origin' or numeric <code>tyler.shape</code> is used with respect to origin or the given value, respectively, to obtain the spatial signs.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a function which indicates what should happen when the data
contain 'NA's.  Default is to fail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments that can be passed on to <code>tyler.shape</code> or <code>HR.Mest</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a one step M-estimator of shape which is standardized in such a way that the determinant is 1.
</p>
<p>The exact formula is:
</p>
<p style="text-align: center;"><code class="reqn">V = V_{0}^{\frac{1}{2}} ave\{a(\frac{R_{i}}{n+1})u_{i}'u_{i} \} V_{0}^{\frac{1}{2}}.</code>
</p>

<p>where <code class="reqn">V_{0}</code> is Tyler's shape matrix, <code class="reqn">u_{i}=||z_{i}||^{-1} z_{i}</code> is the spatial sign of <code class="reqn">z_{i}=(x_{i}-\mu) V_{0}^{-\frac{1}{2}}</code>
and <code class="reqn">R_{i}</code>
gives the rank of <code class="reqn">||z_{i}||</code> among <code class="reqn">||z_{1}||,\ldots,||z_{n}||</code>. The van der Warden score function <code class="reqn">a(.)</code> is the inverse of the cdf of a chi-squared distribution with p degrees of freedom.
</p>
<p>This scatter matrix is based on the test for shape developed in the paper by Hallin and Paindaveine (2006), its usage with respect to the origin is demonstrated in Nordhausen et al. (2006).
</p>


<h3>Author(s)</h3>

<p>Klaus Nordhausen</p>


<h3>References</h3>

<p><cite>Hallin, M. and Paindaveine, D. (2006), Semiparametrically efficient rank-based inference for shape. I. Optimal rank-based tests for sphericity, <em>Annals of Statistics</em>, <b>34</b>,  2707–2756. </cite>
</p>
<p><cite>Nordhausen, K., Oja, H. and Paindaveine, D. (2009), Signed-rank tests for location in the symmetric independent component model, <em>Journal of Multivariate Analysis</em>, <b>100</b>,  821–834. </cite></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(654321)
cov.matrix &lt;- matrix(c(3,2,1,2,4,-0.5,1,-0.5,2), ncol=3)
X &lt;- rmvnorm(100, c(0,0,0), cov.matrix)
HP1.shape(X)
HP1.shape(X, location="Origin")
cov.matrix/det(cov.matrix)^(1/3)
rm(.Random.seed)
         </code></pre>


</div>