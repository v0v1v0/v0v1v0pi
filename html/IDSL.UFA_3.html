<div class="container">

<table style="width: 100%;"><tr>
<td>detect_formula_sets </td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Organic Class Detection by Repeated Unit Patterns
</h2>

<h3>Description</h3>

<p>This function sorts a vector of molecular formulas to aggregate organic compound classes with repeated/non-repeated substructure units. This function only works for molecular formulas with following elements: c("As", "Br", "Cl", "Na", "Se", "Si", "B", "C", "F", "H", "I", "K", "N", "O", "P", "S")
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_formula_sets(molecular_formulas, ratio_delta_HBrClFI_C = 2,
mixed.HBrClFI.allowed = FALSE, min_molecular_formula_class = 2,
max_number_formula_class = 100, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>molecular_formulas</code></td>
<td>

<p>a vector of molecular formulas
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_delta_HBrClFI_C</code></td>
<td>

<p>c(2, 1/2, 0).
2 to detect structures with linear carbon chains such as PFAS, lipids, chlorinated paraffins, etc.
1/2 to detect structures with cyclic chains such as PAHs.
0 to detect molecular formulas with a fixed structures but changing H/Br/Cl/F/I atoms similar to PCBs, PBDEs, etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixed.HBrClFI.allowed</code></td>
<td>

<p>mixed.HBrClFI.allowed = c(TRUE, FALSE). Select 'FALSE' to detect halogenated-saturated compounds similar to PFOS or select 'TRUE' to detect mixed halogenated compounds with hydrogen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_molecular_formula_class</code></td>
<td>

<p>minimum number of molecular formulas in each class. This number should be greater than or equal to 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_number_formula_class</code></td>
<td>

<p>maximum number of molecular formulas in each class
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded computations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of clustered classes of organic molecular formulas.
</p>


<h3>Examples</h3>

<pre><code class="language-R">molecular_formulas &lt;- c("C3F7O3S", "C4F9O3S", "C5F11O3S", "C6F9O3S", "C8F17O3S",
"C9F19O3S", "C10F21O3S", "C7ClF14O4", "C10ClF20O4", "C11ClF22O4", "C11Cl2F21O4",
"C12ClF24O4")
##
ratio_delta_HBrClFI_C &lt;- 2 # to aggregate polymeric classes
mixed.HBrClFI.allowed &lt;- FALSE # To detect only halogen saturated classes
min_molecular_formula_class &lt;- 2
max_number_formula_class &lt;- 20
##
classes &lt;- detect_formula_sets(molecular_formulas, ratio_delta_HBrClFI_C,
mixed.HBrClFI.allowed, min_molecular_formula_class, max_number_formula_class,
number_processing_threads = 1)
</code></pre>


</div>