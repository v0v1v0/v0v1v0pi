<div class="container">

<table style="width: 100%;"><tr>
<td>longtsPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot Very Long Regular Time Series </h2>

<h3>Description</h3>

<p>Plot one or more regular time series in multiple figures on one or
more pages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">longtsPlot(y1, y2 = NULL,
           names1 = NULL, names2 = NULL,
           startP = start(y1)[1], upf = 400, fpp = 4, overlap = 20,
           x.at = NULL, x.ann = NULL, x.tick = NULL,
           y1.at = NULL, y1.ann = NULL, y1.tick = NULL,
           y2.at = NULL, y2.ann = NULL, y2.tick = NULL,
           nx.ann = 10, ny.ann = 3, cex.ann = par("cex.axis"),
           xlab = "", y1lab = "", y2lab = "", las = 0,
           col.y1 = "black", col.y2 = col.y1,
           cex.lab = par("cex.lab"),
           y1lim = range(y1, na.rm = TRUE, finite=TRUE),
           y2lim = range(y2, na.rm = TRUE, finite=TRUE),
           lty1 = 1, lty2 = 2, lwd1 = 1, lwd2 = lwd1,
           col1 = NULL, col2 = NULL,
           leg = TRUE, y1nam.leg = NULL, y2nam.leg = NULL,
           ncol.leg = NULL, cex.leg = par("cex"),
           h1 = NULL, h2 = NULL, col.h1 = "gray70", col.h2 = "gray70",
           main = NULL, cex.main = par("cex.main"),
           automain = is.null(main),
           mgp = c(2, 0.7, 0), mar = c(2,3,1,3)+.2,
           oma = if (automain|!is.null(main))
                             c(0,0,2,0) else par("oma"),
           xpd = par("xpd"), cex = par("cex"),
           type1 = "s", type2 = type1,
           pch1 = 46, pch2 = pch1, cex.pt1 = 2, cex.pt2 = cex.pt1,
           slide = FALSE, each.fig = 1,
           filename = NULL, extension = NULL, filetype = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1, y2</code></td>
<td>
<p> Regular time series, time series matrices or ordinary
vectors, dataframes or matrices with values corresponding to regular
time intervals. Corresponding axes are on the left (for <code>y1</code>)
and on the right (for <code>y2</code>) respectively. <code>y2</code> is optional
and may have a different frequency and a different start time. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names1, names2</code></td>
<td>
<p> Names for time series used for legend. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startP</code></td>
<td>
<p> Start time of plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upf</code></td>
<td>
<p> Number of time units plottet per figure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpp</code></td>
<td>
<p> Number of figures per page (screen). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p> Length of time series on the right end of the figures
which is identical with the left start of the next figure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.at</code></td>
<td>
<p> Time points at which long ticks on x-axis and annotations
are set. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.ann</code></td>
<td>
<p> Time annotations (character vector) for long ticks on
x-axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.tick</code></td>
<td>
<p> Time points at which short ticks are set on x-axis. If
Null, no short ticks are set. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.at, y1.ann, y1.tick, y2.at, y2.ann, y2.tick</code></td>
<td>
<p>Arguments
starting with 'y1' ('y2') correspond to arguments for left (right)
axis. For details see arguments for x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx.ann, ny.ann</code></td>
<td>
<p>Approximate number of annotations on x- and
y-axes, respectively </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.ann</code></td>
<td>
<p> The magnification to be used for axis annotation
relative to the current setting of cex. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> Label for x-axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1lab, y2lab</code></td>
<td>
<p> Labels for y-axes on the left and on the right
end of the figure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p> Cf. <code>par</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.y1, col.y2</code></td>
<td>
<p> Colors for left and right axis respectively. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p> cex of labels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1lim, y2lim</code></td>
<td>
<p> Limits for left and right axis respectively. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty1, lty2</code></td>
<td>
<p> Vector of line types for each time series, possibly
recycled. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd1, lwd2</code></td>
<td>
<p> Vector of line widths for each time series,
possibly recycled. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1, col2</code></td>
<td>
<p> Vector of color for each time series, possibly
recycled. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p> Logical. When TRUE, legend is drawn. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1nam.leg, y2nam.leg</code></td>
<td>
<p> Name of y1- and y2-axis in legend.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.leg</code></td>
<td>
<p> Number of columns in legend. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.leg</code></td>
<td>
<p> cex for legend. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1, h2</code></td>
<td>
<p> Vector of y-positions of horizontal lines in the
coordinate systems represented by the left and the right axis
respectively. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.h1, col.h2</code></td>
<td>
<p> Vector of colors for horizontal lines. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> Title of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p> cex of title.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>automain</code></td>
<td>
<p> Logical. When <code>TRUE</code>, the units of the start and
the end on the page are printed in the title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgp, mar, oma</code></td>
<td>
<p> Cf. <code>par</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>
<p> Define whether data points are clipped to the plot region
(=FALSE) or not (=TRUE). Horizontal lines, defined by <code>h1</code> or
<code>h2</code> are always clipped. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p> Cf. <code>par</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type1, type2</code></td>
<td>
<p> For plotting lines or
points. Cf. <code>plot</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch1, pch2, cex.pt1, cex.pt2</code></td>
<td>
<p>Plotting symbols and there sizes
when 'type1' or 'type2' = "p"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slide</code></td>
<td>
<p> Logical. When <code>FALSE</code>, the first page (screen) is
plotted only. When <code>TRUE</code>, user may leaf through the pages
interactively. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>each.fig</code></td>
<td>
<p> For <code>each.fig==1</code> all data are plotted.
for <code>each.fig==2</code> every 2nd page is plotted and
so on. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>When <code>filename</code> is not
<code>NULL</code>, the displayed screen(s) are saved to
disk and there is no question whether the next page should be
printed. When <code>slide = TRUE</code>, the filename of the plots is
extended by a serial number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extension</code></td>
<td>
<p>The extension is defined automatically
on windows systems and must be defined manually on the other
systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filetype</code></td>
<td>
 <p><em>On Windows</em>:
The type of plot, Windows metafile, PNG, JPEG,
BMP (Windows bitmap format), TIFF, PostScript or PDF.
Defaults to Windows meta file, <code>"wmf"</code> ,
with the extension <code>".wmf"</code>.
Cf. <code>savePlot</code>.
<br><em>On non Windows operating systems</em>: A device
function (e.g., x11, postscript,...). The filetype
defaults to <code>postscript</code> , with the extension
<code>".ps"</code>. Cf. <code>dev.print</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to
<code>savePlot</code> and
<code>dev.print</code> respectively.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For longer time-series, it is sometimes important to spread several
time-series plots over several subplots or even over several pages
with several subplots in each. Moreover, these series have often
different ranges, frequencies and start times. There is sometimes also
the need of a more flexible annotation of axes than <code>plot.ts</code>
provides. <code>longtsPlot</code> provides the user with all these features
for one or two matrices or regular time series (time series matrices).
</p>


<h3>Side Effects</h3>

<p>One or more pages of time series plots are drawn on the current
graphic device and, optionally, saved in one or more files.
</p>


<h3>Author(s)</h3>

<p> Rene Locher </p>


<h3>Examples</h3>

<pre><code class="language-R">## sunspots, y-axis only on the left
data(sunspots)
longtsPlot(sunspots,upf=ceiling((end(sunspots)-start(sunspots))[1]/5))

## air quality (left axis) and meteo data (right axis)
## use xpd=TRUE for time series with rare but large values
if (require(SwissAir)) {
  data(AirQual)
  st &lt;- 6.5*30*48
  x.at &lt;- seq(st,nrow(AirQual),48)
  longtsPlot(y1=AirQual[,c("ad.O3","ad.NOx")], y2 = AirQual$ad.T,
             names1=c("O3","NOx"),names2 = "Temp",
             startP = st, upf=7*48,
             x.at = x.at, x.ann = substr(AirQual$start,1,6)[x.at],
             x.tick = seq(st,nrow(AirQual),12),
             y1.at = c(0,100), y1.tick = seq(0,150,50),
             y2.at = c(10,30), y2.tick = seq(10,30,10),
             y1lab="[ppb]", y2lab="[C]",
             y1lim = c(0,100), y2lim = c(10,30), xpd=TRUE,
             col2 = "red", type1 = "l")
}

## Two time series with different frequencies and start times
## on the same figures
set.seed(13)
len &lt;- 4*6*400
x &lt;- sin((1:len)/200*pi)
d &lt;- sin(cumsum(1+ rpois(len, lambda= 2.5)))

y1 &lt;- ts(10*x,start=0,frequency=6)+d*rnorm(len)
y2 &lt;- ts(100*x,start=100,frequency=13)+10*rnorm(len)
longtsPlot(y1,y2)

## plot your own legend
longtsPlot(sunspots, upf = ceiling((end(sunspots)-start(sunspots))[1]/5),
           fpp = 1, leg = FALSE)
legend(1750, 260, legend = "Monthly Sunspot Numbers", col = "blue", lwd = 1,
       bty = "n")
</code></pre>


</div>