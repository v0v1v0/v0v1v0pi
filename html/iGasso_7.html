<div class="container">

<table style="width: 100%;"><tr>
<td>MR_het_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of Heterogeneity in MR using Principal Components</h2>

<h3>Description</h3>

<p><code>MR_het_test</code> performs tests of heterogeneity in MR. 
</p>



<h3>Usage</h3>

<pre><code class="language-R">MR_het_test(x.b, y.b, x.se, y.se, b0, k = NULL, cum.prop = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.b</code></td>
<td>
<p>a vector of the estimated regression coefficients from the SNP-exposure GWAS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.b</code></td>
<td>
<p>a vector of the estimated regression coefficients from the SNP-outcome GWAS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.se</code></td>
<td>
<p>a vector of SEs for <code>x.b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.se</code></td>
<td>
<p>a vector of SEs for <code>y.b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>a value used for the common effect size. It is used for the weighting matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of principal components used. It is used by the <code class="reqn">\tilde Q(b_0)</code> statistic. The default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.prop</code></td>
<td>
<p>threshold for selecting <code>k</code>. It is void if <code>k</code> is specified. The default is 0.8, i.e., the proportion of variance explained by the top <code>k</code> principal components is 0.8</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
</p>
<p>* <code class="reqn">P_\text{min}(b_0)</code> statistic and its <code class="reqn">P</code>-value.
</p>
<p>* <code class="reqn">\tilde Q_\text{min}(b_0)</code> statistic, its degrees of freedom, and its <code class="reqn">P</code>-value.
</p>


<h3>Author(s)</h3>

<p>Kai Wang <code>&lt;kai-wang@uiowa.edu&gt;</code>
</p>


<h3>References</h3>

<p>Wang, K, Alberding, Steven Y. (2024) Powerful test of heterogeneity in two-sample summary-data Mendelian randomization. Submitted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p = 10
b = 0.5
gamma.true = runif(p, 0.34, 1.1)
x.se = runif(p, 0.06, 0.1)
y.se = runif(p, 0.015, 0.11)
x.b = rnorm(p, gamma.true, x.se)
y.b = rnorm(p, b*gamma.true, y.se)
b0 = 0.4

MR_het_test(x.b, y.b, x.se, y.se, b0)

</code></pre>


</div>