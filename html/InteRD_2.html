<div class="container">

<table style="width: 100%;"><tr>
<td>generateBulk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo bulk data generation function</h2>

<h3>Description</h3>

<p>This function generates a pseudo bulk samples by random sampled number of cells per subject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generateBulk(eset,ct.varname,sample,disease = NULL,ct.sub,prop_mat = NULL,
nbulk = 50,samplewithRep = FALSE,low_s = 0.3,upp_s = 0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eset</code></td>
<td>
<p>The 'ExpressionSet' object for single cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct.varname</code></td>
<td>
<p>Variable name for 'cell types'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>Variable name for subject/samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disease</code></td>
<td>
<p>Indicate the health condition of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct.sub</code></td>
<td>
<p>A subset of cell types that are selected to construct pseudo bulk samples. If NULL, then all cell types are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_mat</code></td>
<td>
<p>Manually input the cell-type proportion for pseudo bulk samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbulk</code></td>
<td>
<p>The number of pseudo bulk samples to be constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplewithRep</code></td>
<td>
<p>Logical, randomly sample single cells with replacement. Default is F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low_s</code></td>
<td>
<p>Lower support a for uniform distribution U[a,b].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upp_s</code></td>
<td>
<p>Upper support b for uniform distribution U[a,b].</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Pseudo bulk samples in the format of 'ExpressionSet',
and the true cell-type proportions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##read data
library(InteRD)
readRDSFromWeb&lt;-function(ref) {readRDS(gzcon(url(ref)))}
urlremote&lt;-"https://github.com/chencxxy28/Data/raw/main/data_InteRD/"
seger&lt;-readRDSFromWeb(paste0(urlremote,"segerstolpe.rds"))

##generate a pseudo bulk data with two samples
set.seed(1234567)
pseudo.seger&lt;-generateBulk(seger[["sc.eset.qc"]], ct.varname = "cluster",
sample = "sample", ct.sub = c("alpha","beta","delta","gamma"),
nbulk = 2, low_s = 0.3, upp_s = 0.7)

</code></pre>


</div>