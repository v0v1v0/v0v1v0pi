<div class="container">

<table style="width: 100%;"><tr>
<td>ipfp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to run IPFP (iterative proportional fitting procedure)</h2>

<h3>Description</h3>

<p>Use IPFP starting from x0 to produce vector x s.t. Ax = y within tolerance.
Need to ensure that x0 &gt; 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ipfp(
  y,
  A,
  x0,
  tol = sqrt(.Machine$double.eps),
  maxit = 1000,
  verbose = FALSE,
  full = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric constraint vector (length nrow)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>constraint matrix (nrow x ncol)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>numeric initial vector (length ncol)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric tolerance for IPFP; defaults to
<code>sqrt(.Machine$double.eps)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer maximum number of iterations for IPFP; defaults to 1e3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical parameter to select verbose output from C function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical parameter to select full return (with diagnostic info)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if not full, a vector of length ncol containing solution obtained by
IPFP. If full, a list containing solution (as x), the number of iterations
(as iter), and the L2 norm of Ax - y (as errNorm)
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- matrix(c(1,0,0, 1,0,0, 0,1,0, 0,1,0, 0,0,1), nrow=3)
x &lt;- rgamma(ncol(A), 10, 1/100)
y &lt;- A %*% x
x0 &lt;- x * rgamma(length(x), 10, 10)
ans &lt;- ipfp(y, A, x0, full=TRUE)
print(ans)
print(x)
</code></pre>


</div>