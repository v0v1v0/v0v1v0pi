<div class="container">

<table style="width: 100%;"><tr>
<td>iso_pen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Penalized Isotonic Regression in one and two dimensions
</h2>

<h3>Description</h3>

<p>Given a response vector y and a predictor matrix xmat with (one or two) columns, the isotonic regression estimator is returned, with the usual (complete or partial) ordering.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">iso_pen(y, xmat, wt = 1, pen = TRUE, default = TRUE, lambda = 0, nsim = 0, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The response vector of length n
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmat</code></td>
<td>

<p>Either a one-dimensional predictor vector or an n by 2 matrix of two-dimensional predictor values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>

<p>Optional weights â€“ a positive vector of length n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>

<p>If pen=FALSE, no penalty is applied to tame spiking.   Default is pen=TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default</code></td>
<td>

<p>If default=FALSE, the user must specify a penalty value.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Optional penalty.   If pen=0, an unpenalized isotonic regression is performed.   If not supplied a default penalty is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>The number of simulations used in the computation of approximate point-wise confidence intervals.   The default is nsim=0, and no confidence intervals are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The confidence level of the confidence intervals.  Default is alpha=.05 (i.e., 95 percent confidence intervals)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The least-squares isotonic regression is computed using the coneA function of the R package coneproj.   
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitted values; i.e., the estimated expected response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sighat</code></td>
<td>
<p>The estimated model standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>The upper points of the point-wise confidence intervals, returned if nsim&gt;0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>The lower points of the point-wise confidence intervals, returned if nsim&gt;0</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mary C Meyer, Professor, Department of Statistics, Colorado State University
</p>


<h3>References</h3>

<p>Meyer, M.C. (2013) A Simple New Algorithm for Quadratic Programming with Applications in Statistics, <em>Communications in Statistics</em>, <b>42(5)</b>, 1126-1139.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### plot the estimated expected lung volume of children given age and height
data(FEV)
x1=FEV[,1]   ## age
x2=FEV[,3]   ## height
y=FEV[,2]
ans=iso_pen(y,cbind(x1,x2))
persp(ans$xg1,ans$xg2,ans$xgmat,th=-40,tick="detailed",xlab="age",ylab="height",zlab="FEV")
</code></pre>


</div>