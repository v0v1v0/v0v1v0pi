<div class="container">

<table style="width: 100%;"><tr>
<td>ivmodel-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Statistical Inference and Sensitivity Analysis for Instrumental
Variables Model
</h2>

<h3>Description</h3>

<p>The package fits an instrumental variables (IV) model of the following type. Let <code class="reqn">Y</code>, <code class="reqn">D</code>, <code class="reqn">X</code>, and <code class="reqn">Z</code> represent the outcome, endogenous variable, <em>p</em> dimensional exogenous covariates, and <em>L</em> dimensional instruments, respectively; note that the intercept can be considered as a vector of ones and a part of the exogenous covariates <code class="reqn">X</code>.The package assumes the following IV model
</p>
<p style="text-align: center;"><code class="reqn"> Y = X \alpha + D \beta + \epsilon, E(\epsilon | X, Z) = 0</code>
</p>

<p>It carries out several IV regressions, diagnostics, and tests associated with the parameter <code class="reqn">\beta</code> in the IV model. Also, if there is only one instrument, the package runs a sensitivity analysis discussed in Jiang et al. (2015).
</p>
<p>The package is robust to most data formats, including factor and character data, and can handle very large IV models efficiently using a sparse QR decomposition.
</p>


<h3>Details</h3>

<p>Supply the outcome <code class="reqn">Y</code>, the endogenous variable <code class="reqn">D</code>, and a data frame and/or matrix of instruments <code class="reqn">Z</code>, and a data frame and/or matrix of exogenous covariates <code class="reqn">X</code> (optional) and run <code>ivmodel</code>. Alternatively, one can supply a formula. <code>ivmodel</code> will generate all the relevant statistics for the parameter <code class="reqn">\beta</code>.
</p>
<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> ivmodel</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Statistical Inference and Sensitivity Analysis for Instrumental
Variables Model</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.9.1</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2023-04-08</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Hyunseung Kang, Yang Jiang, Qingyuan Zhao, and Dylan Small</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Hyunseung Kang &lt;hyunseung@stat.wisc.edu&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Carries out instrumental variable
    estimation of causal effects, including power analysis, sensitivity analysis,
    and diagnostics. See Kang, Jiang, Zhao, and Small (2020) &lt;http://pages.cs.wisc.edu/~hyunseung/&gt; for details.</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> stats,Matrix,Formula,reshape2,ggplot2</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-2 | file LICENSE</td>
</tr>
<tr>
<td style="text-align: left;">
LazyData: </td>
<td style="text-align: left;"> true</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.2.3</td>
</tr>
<tr>
<td style="text-align: left;">
NeedsCompilation: </td>
<td style="text-align: left;"> no</td>
</tr>
<tr>
<td style="text-align: left;">
Repository: </td>
<td style="text-align: left;"> CRAN</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> testthat</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
AR.power                Power of the Anderson-Rubin (1949) Test
AR.size                 Sample Size Calculator for the Power of the
                        Anderson-Rubin (1949) Test
AR.test                 Anderson-Rubin (1949) Test
ARsens.power            Power of the Anderson-Rubin (1949) Test with
                        Sensitivity Analysis
ARsens.size             Sample Size Calculator for the Power of the
                        Anderson-Rubin (1949) Test with Sensitivity
                        Analysis
ARsens.test             Sensitivity Analysis for the Anderson-Rubin
                        (1949) Test
CLR                     Conditional Likelihood Ratio Test
Fuller                  Fuller-k Estimator
IVpower                 Power calculation for IV models
IVsize                  Calculating minimum sample size for achieving a
                        certain power
KClass                  k-Class Estimator
LIML                    Limited Information Maximum Likelihood Ratio
                        (LIML) Estimator
TSLS.power              Power of TSLS Estimator
TSLS.size               Sample Size Calculator for the Power of
                        Asymptotic T-test
balanceLovePlot         Create Love plot of standardized covariate mean
                        differences
biasLovePlot            Create Love plot of treatment bias and
                        instrument bias
card.data               Card (1995) Data
coef.ivmodel            Coefficients of the Fitted Model in the
                        'ivmodel' Object
coefOther               Exogenous Coefficients of the Fitted Model in
                        the 'ivmodel' Object
confint.ivmodel         Confidence Intervals for the Fitted Model in
                        'ivmodel' Object
distributionBalancePlot
                        Plot randomization distributions of the
                        Mahalanobis distance
fitted.ivmodel          Extract Model Fitted values in the 'ivmodel'
                        Object
getCovMeanDiffs         Get Covariate Mean Differences
getMD                   Get Mahalanobis Distance
getStandardizedCovMeanDiffs
                        Get Standardized Covariate Mean Differences
icu.data                Pseudo-data based on Branson and Keele (2020)
iv.diagnosis            Diagnostics of instrumental variable analysis
ivmodel                 Fitting Instrumental Variables (IV) Models
ivmodel-package         Statistical Inference and Sensitivity Analysis
                        for Instrumental Variables Model
ivmodelFormula          Fitting Instrumental Variables (IV) Models
model.matrix.ivmodel    Extract Design Matrix for 'ivmodel' Object
para                    Parameter Estimation from Ivmodel
permTest.absBias        Perform a permutation test using the sum of
                        absolute biases
permTest.md             Perform a permutation test using the
                        Mahalanobis distance
residuals.ivmodel       Residuals from the Fitted Model in the
                        'ivmodel' Object
vcov.ivmodel            Calculate Variance-Covariance Matrix (i.e.
                        Standard Error) for k-Class Estimators in the
                        'ivmodel' Object
vcovOther               Variance of Exogenous Coefficients of the
                        Fitted Model in the 'ivmodel' Object
</pre>


<h3>Author(s)</h3>

<p>Hyunseung Kang, Yang Jiang, Qingyuan Zhao, and Dylan Small
</p>
<p>Maintainer: Hyunseung Kang &lt;hyunseung@stat.wisc.edu&gt;
</p>


<h3>References</h3>

<p>Anderson, T. W. and Rubin, H. (1949). Estimation of the parameters of a single equation in a complete system of stochastic equations. <em>Annals of Mathematical Statistics</em> 20, 46-63.<br></p>
<p>Andrews, D. W. K., Moreira, M. J., and Stock, J. H. (2006). Optimal two-side invariant similar tests for instrumental variables regression. <em>Econometrica</em> 74, 715-752.<br></p>
<p>Card, D.  Using Geographic Variation in College Proximity to Estimate the Return to Schooling. In Aspects of Labor Market Behavior: Essays in Honor of John Vanderkamp, eds. L.N. Christophides, E.K. Grant and R. Swidinsky.  201-222. 
National Longitudinal Survey of Young Men: https://www.nlsinfo.org/investigator/pages/login.jsp
</p>
<p>Fuller, W. (1977). Some properties of a modification of the limited information estimator. <em>Econometrica</em>, 45, 939-953.  <br></p>
<p>Moreira, M. J. (2003). A conditional likelihood ratio test for structural models. <em>Econometrica</em> 71, 1027-1048.   <br></p>
<p>Sargan, J. D. (1958). The estimation of economic relationships using instrumental variables. <em>Econometrica</em> , 393-415. <br></p>
<p>Wang, X., Jiang, Y., Small, D. and Zhang, N. (2017), Sensitivity analysis and power for instrumental variable studies. <em>Biometrics</em> 74(4), 1150-1160. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(card.data)
# One instrument #
Y=card.data[,"lwage"]
D=card.data[,"educ"]
Z=card.data[,"nearc4"]
Xname=c("exper", "expersq", "black", "south", "smsa", "reg661", 
        "reg662", "reg663", "reg664", "reg665", "reg666", "reg667", 
		"reg668", "smsa66")
X=card.data[,Xname]
card.model1IV = ivmodel(Y=Y,D=D,Z=Z,X=X)
card.model1IV

# Multiple instruments
Z = card.data[,c("nearc4","nearc2")]
card.model2IV = ivmodel(Y=Y,D=D,Z=Z,X=X)
card.model2IV
</code></pre>


</div>