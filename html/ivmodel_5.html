<div class="container">

<table style="width: 100%;"><tr>
<td>ARsens.power</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power of the Anderson-Rubin (1949) Test with Sensitivity Analysis</h2>

<h3>Description</h3>

<p><code>ARsens.power</code> computes the power of sensitivity analysis, which is based on an extension of Anderson-Rubin (1949) test and allows IV be possibly invalid within a certain range.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ARsens.power(n, k, beta, gamma, Zadj_sq, sigmau, sigmav, rho, 
             alpha = 0.05, deltarange = deltarange, delta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of exogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>True causal effect minus null hypothesis causal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Regression coefficient for effect of instruments on treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zadj_sq</code></td>
<td>
<p>Variance of instruments after regressed on the observed variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau</code></td>
<td>
<p>Standard deviation of potential outcome under control (structural error for y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmav</code></td>
<td>
<p>Standard deviation of error from regressing treatment on instruments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Correlation between u (potential outcome under control) and v (error from regressing treatment on instrument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltarange</code></td>
<td>
<p>Range of sensitivity allowance. A numeric vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>True value of sensitivity parameter when calculating the power. Usually take delta = 0 for the favorable situation or delta = NULL for unknown delta.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Power of sensitivity analysis for the proposed study, which extends the Anderson-Rubin (1949) test with possibly invalid IV. The power formula is derived in Jiang, Small and Zhang (2015).
</p>


<h3>Author(s)</h3>

<p>Yang Jiang, Hyunseung Kang, and Dylan Small</p>


<h3>References</h3>

<p>Anderson, T.W. and Rubin, H. (1949), Estimation of the parameters of a single equation in a complete system of stochastic equations, Annals of Mathematical Statistics, 20, 46-63.<br>
Wang, X., Jiang, Y., Small, D. and Zhang, N (2017), Sensitivity analysis and power for instrumental variable studies, (under review of Biometrics).</p>


<h3>See Also</h3>

<p>See also <code>ivmodel</code> for details on the instrumental variables model.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Assume we calculate the power of sensitivity analysis in a study with
# one IV (l=1) and the only exogenous variable is the intercept (k=1). 

# Suppose the difference between the null hypothesis and true causal 
# effect is 1 (beta=1).
# The sample size is 250 (n=250), the IV variance is .25 (Zadj_sq =.25).
# The standard deviation of potential outcome is 1(sigmau= 1). 
# The coefficient of regressing IV upon exposure is .5 (gamma= .5).
# The correlation between u and v is assumed to be .5 (rho=.5). 
# The standard deviation of first stage error is .4 (sigmav=.4). 
# The significance level for the study is alpha = .05.

# power of sensitivity analysis under the favorable situation, 
# assuming the range of sensitivity allowance is (-0.1, 0.1)
ARsens.power(n=250, k=1, beta=1, gamma=.5, Zadj_sq=.25, sigmau=1, 
     sigmav=.4, rho=.5, alpha = 0.05, deltarange=c(-0.1, 0.1), delta=0)

# power of sensitivity analysis with unknown delta, 
# assuming the range of sensitivity allowance is (-0.1, 0.1)
ARsens.power(n=250, k=1, beta=1, gamma=.5, Zadj_sq=.25, sigmau=1, 
     sigmav=.4, rho=.5, alpha = 0.05, deltarange=c(-0.1, 0.1))

</code></pre>


</div>