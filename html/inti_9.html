<div class="container">

<table style="width: 100%;"><tr>
<td>H2cal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Broad-sense heritability in plant breeding</h2>

<h3>Description</h3>

<p>Heritability in plant breeding on a genotype difference basis
</p>


<h3>Usage</h3>

<pre><code class="language-R">H2cal(
  data,
  trait,
  gen.name,
  rep.n,
  env.n = 1,
  year.n = 1,
  env.name = NULL,
  year.name = NULL,
  fixed.model,
  random.model,
  summary = FALSE,
  emmeans = FALSE,
  weights = NULL,
  plot_diag = FALSE,
  outliers.rm = FALSE,
  trial = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Experimental design data frame with the factors and traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>Name of the trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen.name</code></td>
<td>
<p>Name of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep.n</code></td>
<td>
<p>Number of replications in the experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env.n</code></td>
<td>
<p>Number of environments (default = 1). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year.n</code></td>
<td>
<p>Number of years (default = 1). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env.name</code></td>
<td>
<p>Name of the environments (default = NULL). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year.name</code></td>
<td>
<p>Name of the years (default = NULL). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.model</code></td>
<td>
<p>The fixed effects in the model (BLUEs). See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.model</code></td>
<td>
<p>The random effects in the model (BLUPs). See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Print summary from random model (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emmeans</code></td>
<td>
<p>Use emmeans for calculate the BLUEs (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of ‘prior weights’ to be used in the
fitting process (default = NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_diag</code></td>
<td>
<p>Show diagnostic plots for fixed and random effects (default
= FALSE). Options: "base", "ggplot". .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers.rm</code></td>
<td>
<p>Remove outliers (default = FALSE). See references.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trial</code></td>
<td>
<p>Column with the name of the trial in the results (default =
NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function allows to made the calculation for individual or
multi-environmental trials (MET) using fixed and random model.
</p>
<p>1. The variance components based in the random model and the population
summary information based in the fixed model (BLUEs).
</p>
<p>2. Heritability under three approaches: Standard (ANOVA), Cullis (BLUPs) and
Piepho (BLUEs).
</p>
<p>3. Best Linear Unbiased Estimators (BLUEs), fixed effect.
</p>
<p>4. Best Linear Unbiased Predictors (BLUPs), random effect.
</p>
<p>5. Table with the outliers removed for each model.
</p>
<p>For individual experiments is necessary provide the <code>trait</code>,
<code>gen.name</code>, <code>rep.n</code>.
</p>
<p>For MET experiments you should <code>env.n</code> and <code>env.name</code> and/or
<code>year.n</code> and <code>year.name</code> according your experiment.
</p>
<p>The BLUEs calculation based in the pairwise comparison could be time
consuming with the increase of the number of the genotypes. You can specify
<code>emmeans = FALSE</code> and the calculate of the BLUEs will be faster.
</p>
<p>If <code>emmeans = FALSE</code> you should change 1 by 0 in the fixed model for
exclude the intersect in the analysis and get all the genotypes BLUEs.
</p>
<p>For more information review the references.
</p>


<h3>Value</h3>

<p>list
</p>


<h3>Author(s)</h3>

<p>Maria Belen Kistner
</p>
<p>Flavio Lozano Isla
</p>


<h3>References</h3>

<p>Bernal Vasquez, Angela Maria, et al. “Outlier Detection Methods for
Generalized Lattices: A Case Study on the Transition from ANOVA to REML.”
Theoretical and Applied Genetics, vol. 129, no. 4, Apr. 2016.
</p>
<p>Buntaran, H., Piepho, H., Schmidt, P., Ryden, J., Halling, M., and Forkman,
J. (2020). Cross validation of stagewise mixed model analysis of Swedish
variety trials with winter wheat and spring barley. Crop Science, 60(5).
</p>
<p>Schmidt, P., J. Hartung, J. Bennewitz, and H.P. Piepho. 2019. Heritability in
Plant Breeding on a Genotype Difference Basis. Genetics 212(4).
</p>
<p>Schmidt, P., J. Hartung, J. Rath, and H.P. Piepho. 2019. Estimating Broad
Sense Heritability with Unbalanced Data from Agricultural Cultivar Trials.
Crop Science 59(2).
</p>
<p>Tanaka, E., and Hui, F. K. C. (2019). Symbolic Formulae for Linear Mixed
Models. In H. Nguyen (Ed.), Statistics and Data Science. Springer.
</p>
<p>Zystro, J., Colley, M., and Dawson, J. (2018). Alternative Experimental
Designs for Plant Breeding. In Plant Breeding Reviews. John Wiley and Sons,
Ltd.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(inti)

dt &lt;- potato

hr &lt;- H2cal(data = dt
            , trait = "stemdw"
            , gen.name = "geno"
            , rep.n = 5
            , fixed.model = "0 + (1|bloque) + geno"
            , random.model = "1 + (1|bloque) + (1|geno)"
            , emmeans = TRUE
            , plot_diag = FALSE
            , outliers.rm = TRUE
            )

 hr$tabsmr
 hr$blues
 hr$blups
 hr$outliers
 
</code></pre>


</div>