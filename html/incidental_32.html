<div class="container">

<table style="width: 100%;"><tr>
<td>train_and_validate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train and validate model on reported data</h2>

<h3>Description</h3>

<p>This function fit models with selected hyperparameters on reported data and return a matrix of posterior Laplace samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">train_and_validate(
  reported,
  delay_dist,
  lam,
  dof,
  beta0 = NULL,
  regularization_order = 2,
  reported_val = NULL,
  end_pad_size = 0,
  fisher_approx_cov = TRUE,
  num_samps_per_ar = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reported</code></td>
<td>
<p>An integer vector of reported cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay_dist</code></td>
<td>
<p>A positive vector that sums to one, which describes the delay distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>A fixed value for the beta parameter regularization strength.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dof</code></td>
<td>
<p>Degrees of freedom for spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>(optional) Initial setting of spline parameters (before optimization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regularization_order</code></td>
<td>
<p>An integer (typically 0, 1, 2), indicating differencing order for L2 
regularization of spline parameters. Default is 2 for second derivative penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reported_val</code></td>
<td>
<p>Validation time series of equal size
to reported vector for use with 'val' method. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_pad_size</code></td>
<td>
<p>And integer number of steps the spline is defined beyond the final 
observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher_approx_cov</code></td>
<td>
<p>A flag to use either the Fisher Information (TRUE) or the Hessian (FALSE) to approx posterior covariance over parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_samps_per_ar</code></td>
<td>
<p>An integer for the number of Laplace samples per AR fit.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of results of train and validate, including: </p>
 
<ul>
<li>
<p> train_ll = training log likelihood
</p>
</li>
<li>
<p> val_ll = validation log likelihood (if 'reported_val' is not 'NULL')
</p>
</li>
<li>
<p> Isamps = samples of the incidence curve from a Laplace approximation
</p>
</li>
<li>
<p> Ihat = MAP estimate of the incidence curve
</p>
</li>
<li>
<p> Chat = expected cases given MAP incidence curve
</p>
</li>
<li>
<p> beta_hat = MAP estimate of spline parameters
</p>
</li>
<li>
<p> beta_cov = covariance of spline parameters
</p>
</li>
<li>
<p> beta_hess = Hessian of spline parameters</p>
</li>
</ul>
</div>