<div class="container">

<table style="width: 100%;"><tr>
<td>getCoefVC.onePhase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get Variance Components' Coefficients and Mean Squares for Single-Phase or
Two-Phase Experiments</h2>

<h3>Description</h3>

<p>Compute the variance components' coefficients and corresponding to random
effects in the expected mean squares of ANOVA table in single-phase or
two-phase experiments. These coefficients are then inserted to a matrix
where the rows correspond to each source of variation and column correspond
to DF and every variance component. The mean squares is calculated if the
<code>response</code> argument is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getCoefVC.onePhase(
  Pb,
  design.df,
  v.mat,
  response,
  table.legend,
  decimal,
  digits
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pb</code></td>
<td>
<p>a list of matrices generated by <code>infoDecompMat</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design.df</code></td>
<td>
<p>a data frame containing the experimental design. Requires
every column be a <code>factor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.mat</code></td>
<td>
<p>a list of matrix generated by <code>getVMat.onePhase</code>
or <code>getVMat.twoPhase</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a numeric vector contains the responses from the
experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table.legend</code></td>
<td>
<p>a logical allows users to generate a legend for the
variance components of the ANOVA table for large designs. Default is
<code>FALSE</code>, resulting in the use of original block factor names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decimal</code></td>
<td>
<p>a logical allows users to display the coefficients as the
decimals. Default is <code>FALSE</code>, resulting in the use of
<code>fractions</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>a integer indicating the number of decimal places. Default is
2, resulting in 2 decimal places.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main purpose of this function is to combine the matrices presenting
every source of variation of the ANOVA table and the variance matrix to
compute the coefficients of the variance components.
</p>
<p>The complication arise in giving the row names of the matrix for the source
of variation in the ANOVA table.
</p>


<h3>Value</h3>

<p>A matrix containing the characters.
</p>


<h3>Author(s)</h3>

<p>Kevin Chang
</p>


<h3>Examples</h3>

<pre><code class="language-R">
design1 &lt;- local({ 
  Ani &lt;- as.factor(LETTERS[c(1,2,3,4,
                            5,6,7,8)])
  Trt &lt;- as.factor(letters[c(1,1,1,1,
                            2,2,2,2)])
  data.frame(Ani, Trt, stringsAsFactors = TRUE )
})

blk.str &lt;- "Ani"
    
rT &lt;- terms(as.formula(paste("~", blk.str, sep = "")), keep.order = TRUE) 
blkTerm &lt;- attr(rT,"term.labels")
     
Z &lt;- makeBlkDesMat(design1, blkTerm)

trt.str &lt;- "Trt"              
fT &lt;- terms(as.formula(paste("~", trt.str, sep = "")), keep.order = TRUE)  #fixed terms

trtTerm &lt;- attr(fT, "term.labels")
effectsMatrix &lt;- attr(fT, "factor")        

T &lt;- makeContrMat(design1, trtTerm, effectsMatrix, contr.vec = NA)

N =  makeOverDesMat(design1, trtTerm)

Replist = getTrtRep(design1, trtTerm)   
 
Rep &lt;- Replist$Rep
trt.Sca &lt;- Replist$Sca
    
effFactors = lapply(makeOrthProjectors(Z), function(z) 
      getEffFactor(z, T, N, Rep, trt.Sca))

#Now construct variance matrices
Pb &lt;- effFactors[sort(1:length(effFactors), decreasing=TRUE)]

v.mat &lt;- getVMat.onePhase(Z.Phase1 = Z, design.df = design.df, var.comp = NA)
    
getCoefVC.onePhase(Pb = Pb, design.df = design1, v.mat = v.mat, response = NA, 
    table.legend = FALSE, decimal = FALSE, digit = 2)

</code></pre>


</div>