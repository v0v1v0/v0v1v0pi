<div class="container">

<table style="width: 100%;"><tr>
<td>midar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Customize the Individual Diversity-Area Relationship Function
</h2>

<h3>Description</h3>

<p>A wrapper to develop new Individual Diversity-Area Relationship functions on the fly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">midar(mippp, mippp.sp = NULL, mimark = NULL, namesmark = NULL, traits = NULL,
tree = NULL, r = NULL, buffer = 0, bfw = NULL, what = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mippp</code></td>
<td>
<p>A multitype (a.k.a. multivariate) marked point pattern. An object with the ppp format of <span class="pkg">spatstat</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mippp.sp</code></td>
<td>
<p>Univariate point pattern of the focal species. An object with the ppp format of <span class="pkg">spatstat</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mimark</code></td>
<td>
<p>Character. Name of the focal species in the multitype <code>mippp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namesmark</code></td>
<td>
<p>Character. If the marks in <code>mippp</code> are within a <code>data.frame</code>, the name of the column with the species names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>One of "adapt", i.e., compute an adaptive buffer, or a number indicating the width of a fixed buffer area around the plot border</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bfw</code></td>
<td>
<p>An owin object indicating the limits of the buffer area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Vector of distances to compute IDAR(r) functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogenetic tree in <code>phylo</code> format (<span class="pkg">ape</span>) or a phylogenetic covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>A data.frame of traits, or a distance matrix among species (in <code>dist</code> or <code>matrix</code> format) computed on a data.frame of traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A valid R expression or function that would accept a community matrix (sites x species) and return a unique value</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>midar</code> allows computing new <em>IDAR</em>(<em>r</em>) functions. The basis of all idar functions are the local communities defined around each point (e.g., each tree) of a focal species (<code>mimark</code>) for a certain circular neighborhood of radius <em>r</em>. Some diversity measure is computed on each community an the average of all of them is returned as the idar value for this <em>r</em>, i.e., as <em>IDAR</em>(<em>r</em>). The function <code>midar</code> applies the R function or expression defined by the argument <code>what</code> to each of the  "community data tables" (matrices) generated by <code>mitable</code> (one for each <em>r</em> interval defined by the argument <code>r</code>) and return the result as a spatial summary function like all the others in the <span class="pkg">idar</span> package (e.g., <code>isar</code> or <code>pisar</code>). The R expression or function should accept a community matrix (sites x species) as input and return a unique numeric value.
</p>


<h3>Value</h3>

<p><code>midar</code> return an object of class <code>fv</code>, see  fv.object, which can be plotted directly using  plot.fv. 
Essentially, a data frame containing a column named <em>r</em> with the vector of values of the argument r at which the proposed function had been estimated and  another column, named <em>"midar"</em> which  contains an estimate of the selected function.
</p>


<h3>Simulation envelopes</h3>

<p>To compute simulation envelopes for  <code>midar</code>  functions,  use <code>envelope</code>. See the examples in this help page and in <code>multifocalsimulator</code> to know how to compute simulation envelopes from appropriate null models.
</p>


<h3>Author(s)</h3>

<p> Marcelino de la Cruz <a href="mailto:marcelino.delacruz@urjc.es">marcelino.delacruz@urjc.es</a></p>


<h3>See Also</h3>

<p><code>isar</code> or <code>pisar</code> in this package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SF)
data(SFphylotree)
 # Discard the size mark and keep the species mark in SF ppp:
  sfsp&lt;- ppp(SF$x, SF$y, window=SF$window, marks=SF$marks$species)

# compute "individual Simpsom diversity-area relationship" around sp_44
# using function diversity from package vegan
require(vegan)
simpsom_sp_44&lt;- midar(sfsp, mimark="sp_44", what =function(x) mean(diversity(x, "simpson")),
                                  r=1:15)


# test "individual Simpsom diversity-area relationship" against an inhomogeneous Poisson
# null modellfor sp_44. 
  # estimate intensityh surface for sp_44
   lambda&lt;- density.ppp(unmark(sfsp[sfsp$marks=="sp_44"]), positive=TRUE)
  
  # generate 19 realizations of the null model, keeping all the other species fixed in their
  #  original coordinates.
   simulados&lt;- multifocalsimulator(sfsp, mimark="sp_44", simulate=expression(rpoispp(lambda)),
                      nsim=19, nmin=15)

  # for simplicity define the function that we want to apply to each "local community"
  #  around each tree of sp_44
  mean_simpsom &lt;- function(x) mean(diversity(x, "simpson"))

  # compute envelopes and plot them.
  simpsom_sp_44.env&lt;-envelope(sfsp, midar, mimark="sp_44", what =mean_simpsom ,r=1:15,
                      nsim=19, simulate=simulados)
  plot(simpsom_sp_44.env)


# compute IPSVAR(r) "by hand"
   # first, check tree as would check it ipsvar
   arbol &lt;- checktree(SFphylotree,  SF, "ipsvar", correct.phylo="exclude")

    # define function to obtain the averge psv from the set of local communities
    #  at each neigborhood radii r
     mipsv &lt;- expression(mean(psv(x, tree=tree, compute.var=FALSE)$PSVs, na.rm=TRUE))
     # compute ipsvar "by hand" 
     sp_44_psv&lt;- midar(sfsp, mimark="sp_44", tree=arbol, what =mipsv ,r=1:15)
     plot(sp_44_psv)

# compare it with the result of the built-in function
     plot(ipsvar(sfsp, mimark="sp_44", tree=arbol, r=1:15), add=TRUE, col="blue")
    
</code></pre>


</div>