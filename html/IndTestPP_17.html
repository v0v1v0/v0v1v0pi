<div class="container">

<table style="width: 100%;"><tr>
<td>DepNHPPMarked</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generating dependent  point processes from  a marked Poison Process</h2>

<h3>Description</h3>

<p> This function  generates <code class="reqn">d</code> dependent  (homogeneous or nonhomogeneous) point processes 
using a marked Poisson process, where the marks are generated by a Markov chain process defined by a  transition matrix.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">DepNHPPMarked(lambdaTot, MarkovM, inival = 1, dplot=TRUE, fixed.seed=NULL,...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambdaTot</code></td>
<td>
<p>Numeric vector. Intensity values  of the Poisson process used to generate the dependent processes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MarkovM</code></td>
<td>
<p>Matrix. Trasition probabilities of  the d-state Markov chain used to generate the marks of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inival</code></td>
<td>
<p>Optional. Initial  mark value used to generate the series of marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dplot</code></td>
<td>
<p>Optional. A logical flag. If it is TRUE,  the  marginal processes  are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.seed</code></td>
<td>
<p>Optional. An integer or NULL. Value used to set the seed 
in random generation processes; if it is NULL, a random seed is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to  be passed to the function <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Points  of the marked Poisson process are generated in continuous time, using the  following procedure: 
First, a trajectory of the underlying Poisson process is generated.  Then, the  mark series is generated 
using a d-state Markov chain. The mark series takes values in 1,2,...,d and determines in which of the d processes  
the points occur.
</p>
<p>The  marginal processes defined by the marks  are not Poisson  unless the generated marks are
independent observations,  see Isham (1980).  
</p>
<p>A transition matrix <code class="reqn">P = (p_{ij})</code> with equal rows leads to <code class="reqn">d</code> independent point processes, and the more 
similar the rows of P, the less dependent the resulting processes.   The spectral gap (<code>SpecGap</code>) 
measures  the dependence between the generated processes,   see Abaurrea et al. (2014).
</p>
<p>Tha marginal processes of the marked process can be optionally plotted using <code>dplot=TRUE</code>.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posNH</code></td>
<td>
<p>A list of  <code class="reqn">d</code> vectors,  containing the occurrence points in each  marginal point process. The name of the 
elements of the list are N1, N2,..., Nd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posNHG</code></td>
<td>
<p>Numeric vector of the occurrences times of the generated Poisson process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>Vector of the  generated marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaTot</code></td>
<td>
<p>Input argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MarkovM</code></td>
<td>
<p>Input argument.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Abaurrea, J. Asin, J. and Cebrian, A.C. (2015). A Bootstrap Test of Independence Between Three Temporal Nonhomogeneous Poisson Processes 
and its Application to Heat Wave Modeling. <em>Environmental and Ecological Statistics</em>,  22(1), 127-144.
</p>
<p>Isham, V. (1980). Dependent thinning of point processes. <em>J. Appl. Probab.</em>, 17(4), 987-95.
</p>


<h3>See Also</h3>

<p><code>DepNHPPqueue</code>, <code>DepNHNeyScot</code>, <code>DepNHCPSP</code>, 
<code>IndNHPP</code>, <code>SpecGap</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generation of three dependent  point processes using a marked PP
set.seed(123)
lambdaTot&lt;-runif(1000)/10
aux&lt;-DepNHPPMarked(lambdaTot=lambdaTot,
	MarkovM=cbind(c(0.3,0.1,0.6), c(0.1, 0.6, 0.3), c(0.6, 0.3,0.1)),fixed.seed=123)
print(cbind(aux$posNH, aux$mark))
print(aux$posNHs)
</code></pre>


</div>